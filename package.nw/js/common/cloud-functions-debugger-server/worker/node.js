module.exports=function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1295)}({0:function(e,t){e.exports=require("util")},1:function(e,t){e.exports=require("path")},111:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.complexTranslate=t.translate=t.setLocale=t.getLocale=void 0;const s=n(234);let o="zh";t.getLocale=()=>o;t.setLocale=e=>{switch(e){case"zh":case"en":o=e}};const r=(e,t,n)=>{try{let n=e;e.__esModule&&(n=e.default);for(const e of t)n=n[e];return n}catch(e){return n}};function i(e,{form:t="defaults",values:n=[]}={}){const i=r(s.default,[e,o,t],void 0);if(!i)return r(s.default,[e,o,"defaults"],void 0)||r(s.default,[e,"en",t],void 0)||r(s.default,[e,"en","defaults"],void 0)||"undefined";if(i.includes("%s")){const e=function(e){return function*(){for(const t of e)yield t}}(n)();return i.replace(/%s/g,()=>e.next().value)}return i}t.translate=function(e,...t){return i(e,{values:t,form:"defaults"})},t.complexTranslate=i},112:function(e,t,n){"use strict";const s=n(5),o=n(3),r=n(18),i=n(14),a=n(17),c=n(67),l=n(6),d=n(55),h=n(238),u=n(113),f=n(114),p=n(116),{BINARY_TYPES:m,EMPTY_BUFFER:_,GUID:g,kStatusCode:y,kWebSocket:v,NOOP:w}=n(35),b=["CONNECTING","OPEN","CLOSING","CLOSED"],S=[8,13],E=3e4;class k extends s{constructor(e,t,n){super(),this.readyState=k.CONNECTING,this.protocol="",this._binaryType=m[0],this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage="",this._closeTimer=null,this._closeCode=1006,this._extensions={},this._receiver=null,this._sender=null,this._socket=null,null!==e?(this._isServer=!1,this._redirects=0,Array.isArray(t)?t=t.join(", "):"object"==typeof t&&null!==t&&(n=t,t=void 0),function e(t,n,s,a){const c=Object.assign({protocolVersion:S[1],maxPayload:104857600,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10},a,{createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:void 0,auth:void 0,host:void 0,path:void 0,port:void 0});if(!S.includes(c.protocolVersion))throw new RangeError(`Unsupported protocol version: ${c.protocolVersion} `+`(supported versions: ${S.join(", ")})`);var h;"object"==typeof n&&void 0!==n.href?(h=n,t.url=n.href):(h=l.URL?new l.URL(n):l.parse(n),t.url=n);const f="ws+unix:"===h.protocol;if(!(h.host||f&&h.pathname))throw new Error(`Invalid URL: ${t.url}`);const p="wss:"===h.protocol||"https:"===h.protocol,m=p?443:80,_=o.randomBytes(16).toString("base64"),y=p?r.get:i.get,v=h.search?`${h.pathname||"/"}${h.search}`:h.pathname||"/";var w;c.createConnection=p?C:x,c.defaultPort=c.defaultPort||m,c.port=h.port||m,c.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,c.headers=Object.assign({"Sec-WebSocket-Version":c.protocolVersion,"Sec-WebSocket-Key":_,Connection:"Upgrade",Upgrade:"websocket"},c.headers),c.path=v,c.timeout=c.handshakeTimeout,c.perMessageDeflate&&(w=new d(!0!==c.perMessageDeflate?c.perMessageDeflate:{},!1,c.maxPayload),c.headers["Sec-WebSocket-Extensions"]=u.format({[d.extensionName]:w.offer()}));s&&(c.headers["Sec-WebSocket-Protocol"]=s);c.origin&&(c.protocolVersion<13?c.headers["Sec-WebSocket-Origin"]=c.origin:c.headers.Origin=c.origin);h.auth?c.auth=h.auth:(h.username||h.password)&&(c.auth=`${h.username}:${h.password}`);if(f){const e=v.split(":");c.socketPath=e[0],c.path=e[1]}var b=t._req=y(c);c.timeout&&b.on("timeout",()=>{N(t,b,"Opening handshake has timed out")});b.on("error",e=>{t._req.aborted||(b=t._req=null,t.readyState=k.CLOSING,t.emit("error",e),t.emitClose())}),b.on("response",o=>{const r=o.headers.location,i=o.statusCode;if(r&&c.followRedirects&&i>=300&&i<400){if(++t._redirects>c.maxRedirects)return void N(t,b,"Maximum redirects exceeded");b.abort();const o=l.URL?new l.URL(r,n):l.resolve(n,r);e(t,o,s,a)}else t.emit("unexpected-response",b,o)||N(t,b,`Unexpected server response: ${o.statusCode}`)}),b.on("upgrade",(e,n,r)=>{if(t.emit("upgrade",e),t.readyState!==k.CONNECTING)return;b=t._req=null;const i=o.createHash("sha1").update(_+g).digest("base64");if(e.headers["sec-websocket-accept"]!==i)return void N(t,n,"Invalid Sec-WebSocket-Accept header");const a=e.headers["sec-websocket-protocol"],l=(s||"").split(/, */);var h;if(!s&&a?h="Server sent a subprotocol but none was requested":s&&!a?h="Server sent no subprotocol":a&&!l.includes(a)&&(h="Server sent an invalid subprotocol"),h)N(t,n,h);else{if(a&&(t.protocol=a),w)try{const n=u.parse(e.headers["sec-websocket-extensions"]);n[d.extensionName]&&(w.accept(n[d.extensionName]),t._extensions[d.extensionName]=w)}catch(e){return void N(t,n,"Invalid Sec-WebSocket-Extensions header")}t.setSocket(n,r,c.maxPayload)}})}(this,e,t,n)):this._isServer=!0}get CONNECTING(){return k.CONNECTING}get CLOSING(){return k.CLOSING}get CLOSED(){return k.CLOSED}get OPEN(){return k.OPEN}get binaryType(){return this._binaryType}set binaryType(e){m.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?(this._socket.bufferSize||0)+this._sender._bufferedBytes:0}get extensions(){return Object.keys(this._extensions).join()}setSocket(e,t,n){const s=new f(this._binaryType,this._extensions,n);this._sender=new p(e,this._extensions),this._receiver=s,this._socket=e,s[v]=this,e[v]=this,s.on("conclude",T),s.on("drain",O),s.on("error",L),s.on("message",I),s.on("ping",q),s.on("pong",B),e.setTimeout(0),e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",P),e.on("data",D),e.on("end",U),e.on("error",M),this.readyState=k.OPEN,this.emit("open")}emitClose(){this.readyState=k.CLOSED,this._socket?(this._extensions[d.extensionName]&&this._extensions[d.extensionName].cleanup(),this._receiver.removeAllListeners(),this.emit("close",this._closeCode,this._closeMessage)):this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==k.CLOSED){if(this.readyState===k.CONNECTING){const e="WebSocket was closed before the connection was established";return N(this,this._req,e)}this.readyState!==k.CLOSING?(this.readyState=k.CLOSING,this._sender.close(e,t,!this._isServer,e=>{e||(this._closeFrameSent=!0,this._closeFrameReceived&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),E)):this._closeFrameSent&&this._closeFrameReceived&&this._socket.end()}}ping(e,t,n){if("function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),this.readyState!==k.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${b[this.readyState]})`);if(n)return n(e);throw e}"number"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.ping(e||_,t,n)}pong(e,t,n){if("function"==typeof e?(n=e,e=t=void 0):"function"==typeof t&&(n=t,t=void 0),this.readyState!==k.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${b[this.readyState]})`);if(n)return n(e);throw e}"number"==typeof e&&(e=e.toString()),void 0===t&&(t=!this._isServer),this._sender.pong(e||_,t,n)}send(e,t,n){if("function"==typeof t&&(n=t,t={}),this.readyState!==k.OPEN){const e=new Error(`WebSocket is not open: readyState ${this.readyState} `+`(${b[this.readyState]})`);if(n)return n(e);throw e}"number"==typeof e&&(e=e.toString());const s=Object.assign({binary:"string"!=typeof e,mask:!this._isServer,compress:!0,fin:!0},t);this._extensions[d.extensionName]||(s.compress=!1),this._sender.send(e||_,s,n)}terminate(){if(this.readyState!==k.CLOSED){if(this.readyState===k.CONNECTING){const e="WebSocket was closed before the connection was established";return N(this,this._req,e)}this._socket&&(this.readyState=k.CLOSING,this._socket.destroy())}}}function x(e){return e.protocolVersion&&(e.path=e.socketPath),a.connect(e)}function C(e){return e.path=void 0,e.servername=e.servername||e.host,c.connect(e)}function N(e,t,n){e.readyState=k.CLOSING;const s=new Error(n);Error.captureStackTrace(s,N),t.setHeader?(t.abort(),t.once("abort",e.emitClose.bind(e)),e.emit("error",s)):(t.destroy(s),t.once("error",e.emit.bind(e,"error")),t.once("close",e.emitClose.bind(e)))}function T(e,t){const n=this[v];n._socket.removeListener("data",D),n._socket.resume(),n._closeFrameReceived=!0,n._closeMessage=t,n._closeCode=e,1005===e?n.close():n.close(e,t)}function O(){this[v]._socket.resume()}function L(e){const t=this[v];t._socket.removeListener("data",D),t.readyState=k.CLOSING,t._closeCode=e[y],t.emit("error",e),t._socket.destroy()}function R(){this[v].emitClose()}function I(e){this[v].emit("message",e)}function q(e){const t=this[v];t.pong(e,!t._isServer,w),t.emit("ping",e)}function B(e){this[v].emit("pong",e)}function P(){const e=this[v];this.removeListener("close",P),this.removeListener("end",U),e.readyState=k.CLOSING,e._socket.read(),e._receiver.end(),this.removeListener("data",D),this[v]=void 0,clearTimeout(e._closeTimer),e._receiver._writableState.finished||e._receiver._writableState.errorEmitted?e.emitClose():(e._receiver.on("error",R),e._receiver.on("finish",R))}function D(e){this[v]._receiver.write(e)||this.pause()}function U(){const e=this[v];e.readyState=k.CLOSING,e._receiver.end(),this.end()}function M(){const e=this[v];this.removeListener("error",M),this.on("error",w),e.readyState=k.CLOSING,this.destroy()}b.forEach((e,t)=>{k[e]=t}),["open","error","close","message"].forEach(e=>{Object.defineProperty(k.prototype,`on${e}`,{get(){const t=this.listeners(e);for(var n=0;n<t.length;n++)if(t[n]._listener)return t[n]._listener},set(t){const n=this.listeners(e);for(var s=0;s<n.length;s++)n[s]._listener&&this.removeListener(e,n[s]);this.addEventListener(e,t)}})}),k.prototype.addEventListener=h.addEventListener,k.prototype.removeEventListener=h.removeEventListener,e.exports=k},113:function(e,t,n){"use strict";const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function o(e,t,n){Object.prototype.hasOwnProperty.call(e,t)?e[t].push(n):e[t]=[n]}e.exports={format:function(e){return Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>[t].concat(Object.keys(e).map(t=>{var n=e[t];return Array.isArray(n)||(n=[n]),n.map(e=>!0===e?t:`${t}=${e}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(e){const t={};if(void 0===e||""===e)return t;for(var n,r,i={},a=!1,c=!1,l=!1,d=-1,h=-1,u=0;u<e.length;u++){const p=e.charCodeAt(u);if(void 0===n)if(-1===h&&1===s[p])-1===d&&(d=u);else if(32===p||9===p)-1===h&&-1!==d&&(h=u);else{if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${u}`);{if(-1===d)throw new SyntaxError(`Unexpected character at index ${u}`);-1===h&&(h=u);const s=e.slice(d,h);44===p?(o(t,s,i),i={}):n=s,d=h=-1}}else if(void 0===r)if(-1===h&&1===s[p])-1===d&&(d=u);else if(32===p||9===p)-1===h&&-1!==d&&(h=u);else if(59===p||44===p){if(-1===d)throw new SyntaxError(`Unexpected character at index ${u}`);-1===h&&(h=u),o(i,e.slice(d,h),!0),44===p&&(o(t,n,i),i={},n=void 0),d=h=-1}else{if(61!==p||-1===d||-1!==h)throw new SyntaxError(`Unexpected character at index ${u}`);r=e.slice(d,u),d=h=-1}else if(c){if(1!==s[p])throw new SyntaxError(`Unexpected character at index ${u}`);-1===d?d=u:a||(a=!0),c=!1}else if(l)if(1===s[p])-1===d&&(d=u);else if(34===p&&-1!==d)l=!1,h=u;else{if(92!==p)throw new SyntaxError(`Unexpected character at index ${u}`);c=!0}else if(34===p&&61===e.charCodeAt(u-1))l=!0;else if(-1===h&&1===s[p])-1===d&&(d=u);else if(-1===d||32!==p&&9!==p){if(59!==p&&44!==p)throw new SyntaxError(`Unexpected character at index ${u}`);if(-1===d)throw new SyntaxError(`Unexpected character at index ${u}`);-1===h&&(h=u);var f=e.slice(d,h);a&&(f=f.replace(/\\/g,""),a=!1),o(i,r,f),44===p&&(o(t,n,i),i={},n=void 0),r=void 0,d=h=-1}else-1===h&&(h=u)}if(-1===d||l)throw new SyntaxError("Unexpected end of input");-1===h&&(h=u);const p=e.slice(d,h);return void 0===n?o(t,p,{}):(void 0===r?o(i,p,!0):o(i,r,a?p.replace(/\\/g,""):p),o(t,n,i)),t}}},114:function(e,t,n){"use strict";const{Writable:s}=n(4),o=n(55),{BINARY_TYPES:r,EMPTY_BUFFER:i,kStatusCode:a,kWebSocket:c}=n(35),{concat:l,toArrayBuffer:d,unmask:h}=n(69),{isValidStatusCode:u,isValidUTF8:f}=n(115),p=0,m=1,_=2,g=3,y=4,v=5;function w(e,t,n,s){const o=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(o,w),o[a]=s,o}e.exports=class extends s{constructor(e,t,n){super(),this._binaryType=e||r[0],this[c]=void 0,this._extensions=t||{},this._maxPayload=0|n,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=p,this._loop=!1}_write(e,t,n){if(8===this._opcode&&this._state==p)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){const t=this._buffers[0];return this._buffers[0]=t.slice(e),t.slice(0,e)}const t=Buffer.allocUnsafe(e);do{const n=this._buffers[0];e>=n.length?this._buffers.shift().copy(t,t.length-e):(n.copy(t,t.length-e,0,e),this._buffers[0]=n.slice(e)),e-=n.length}while(e>0);return t}startLoop(e){var t;this._loop=!0;do{switch(this._state){case p:t=this.getInfo();break;case m:t=this.getPayloadLength16();break;case _:t=this.getPayloadLength64();break;case g:this.getMask();break;case y:t=this.getData(e);break;default:return void(this._loop=!1)}}while(this._loop);e(t)}getInfo(){if(this._bufferedBytes<2)return void(this._loop=!1);const e=this.consume(2);if(0!=(48&e[0]))return this._loop=!1,w(RangeError,"RSV2 and RSV3 must be clear",!0,1002);const t=64==(64&e[0]);if(t&&!this._extensions[o.extensionName])return this._loop=!1,w(RangeError,"RSV1 must be clear",!0,1002);if(this._fin=128==(128&e[0]),this._opcode=15&e[0],this._payloadLength=127&e[1],0===this._opcode){if(t)return this._loop=!1,w(RangeError,"RSV1 must be clear",!0,1002);if(!this._fragmented)return this._loop=!1,w(RangeError,"invalid opcode 0",!0,1002);this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return this._loop=!1,w(RangeError,`invalid opcode ${this._opcode}`,!0,1002);this._compressed=t}else{if(!(this._opcode>7&&this._opcode<11))return this._loop=!1,w(RangeError,`invalid opcode ${this._opcode}`,!0,1002);if(!this._fin)return this._loop=!1,w(RangeError,"FIN must be set",!0,1002);if(t)return this._loop=!1,w(RangeError,"RSV1 must be clear",!0,1002);if(this._payloadLength>125)return this._loop=!1,w(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002)}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=128==(128&e[1]),126===this._payloadLength)this._state=m;else{if(127!==this._payloadLength)return this.haveLength();this._state=_}}getPayloadLength16(){if(!(this._bufferedBytes<2))return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength();this._loop=!1}getPayloadLength64(){if(this._bufferedBytes<8)return void(this._loop=!1);const e=this.consume(8),t=e.readUInt32BE(0);return t>Math.pow(2,21)-1?(this._loop=!1,w(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009)):(this._payloadLength=t*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,w(RangeError,"Max payload size exceeded",!1,1009);this._masked?this._state=g:this._state=y}getMask(){this._bufferedBytes<4?this._loop=!1:(this._mask=this.consume(4),this._state=y)}getData(e){var t=i;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength)return void(this._loop=!1);t=this.consume(this._payloadLength),this._masked&&h(t,this._mask)}return this._opcode>7?this.controlMessage(t):this._compressed?(this._state=v,void this.decompress(t,e)):(t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage())}decompress(e,t){this._extensions[o.extensionName].decompress(e,this._fin,(e,n)=>{if(e)return t(e);if(n.length){if(this._messageLength+=n.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return t(w(RangeError,"Max payload size exceeded",!1,1009));this._fragments.push(n)}const s=this.dataMessage();if(s)return t(s);this.startLoop(t)})}dataMessage(){if(this._fin){const t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){var e;e="nodebuffer"===this._binaryType?l(n,t):"arraybuffer"===this._binaryType?d(l(n,t)):n,this.emit("message",e)}else{const e=l(n,t);if(!f(e))return this._loop=!1,w(Error,"invalid UTF-8 sequence",!0,1007);this.emit("message",e.toString())}}this._state=p}controlMessage(e){if(8===this._opcode)if(this._loop=!1,0===e.length)this.emit("conclude",1005,""),this.end();else{if(1===e.length)return w(RangeError,"invalid payload length 1",!0,1002);{const t=e.readUInt16BE(0);if(!u(t))return w(RangeError,`invalid status code ${t}`,!0,1002);const n=e.slice(2);if(!f(n))return w(Error,"invalid UTF-8 sequence",!0,1007);this.emit("conclude",t,n.toString()),this.end()}}else 9===this._opcode?this.emit("ping",e):this.emit("pong",e);this._state=p}}},115:function(e,t,n){"use strict";try{const e=n(!function(){var e=new Error("Cannot find module 'utf-8-validate'");throw e.code="MODULE_NOT_FOUND",e}());t.isValidUTF8="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.isValidUTF8=()=>!0}t.isValidStatusCode=e=>e>=1e3&&e<=1013&&1004!==e&&1005!==e&&1006!==e||e>=3e3&&e<=4999},116:function(e,t,n){"use strict";const{randomBytes:s}=n(3),o=n(55),{EMPTY_BUFFER:r}=n(35),{isValidStatusCode:i}=n(115),{mask:a,toBuffer:c}=n(69);class l{constructor(e,t){this._extensions=t||{},this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){const n=t.mask&&t.readOnly;var o=t.mask?6:2,r=e.length;e.length>=65536?(o+=8,r=127):e.length>125&&(o+=2,r=126);const i=Buffer.allocUnsafe(n?e.length+o:o);if(i[0]=t.fin?128|t.opcode:t.opcode,t.rsv1&&(i[0]|=64),i[1]=r,126===r?i.writeUInt16BE(e.length,2):127===r&&(i.writeUInt32BE(0,2),i.writeUInt32BE(e.length,6)),!t.mask)return[i,e];const c=s(4);return i[1]|=128,i[o-4]=c[0],i[o-3]=c[1],i[o-2]=c[2],i[o-1]=c[3],n?(a(e,c,i,o,e.length),[i]):(a(e,c,e,0,e.length),[i,e])}close(e,t,n,s){var o;if(void 0===e)o=r;else{if("number"!=typeof e||!i(e))throw new TypeError("First argument must be a valid error code number");void 0===t||""===t?(o=Buffer.allocUnsafe(2)).writeUInt16BE(e,0):((o=Buffer.allocUnsafe(2+Buffer.byteLength(t))).writeUInt16BE(e,0),o.write(t,2))}this._deflating?this.enqueue([this.doClose,o,n,s]):this.doClose(o,n,s)}doClose(e,t,n){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:8,mask:t,readOnly:!1}),n)}ping(e,t,n){const s=c(e);this._deflating?this.enqueue([this.doPing,s,t,c.readOnly,n]):this.doPing(s,t,c.readOnly,n)}doPing(e,t,n,s){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:9,mask:t,readOnly:n}),s)}pong(e,t,n){const s=c(e);this._deflating?this.enqueue([this.doPong,s,t,c.readOnly,n]):this.doPong(s,t,c.readOnly,n)}doPong(e,t,n,s){this.sendFrame(l.frame(e,{fin:!0,rsv1:!1,opcode:10,mask:t,readOnly:n}),s)}send(e,t,n){const s=c(e),r=this._extensions[o.extensionName];var i=t.binary?2:1,a=t.compress;if(this._firstFragment?(this._firstFragment=!1,a&&r&&(a=s.length>=r._threshold),this._compress=a):(a=!1,i=0),t.fin&&(this._firstFragment=!0),r){const e={fin:t.fin,rsv1:a,opcode:i,mask:t.mask,readOnly:c.readOnly};this._deflating?this.enqueue([this.dispatch,s,this._compress,e,n]):this.dispatch(s,this._compress,e,n)}else this.sendFrame(l.frame(s,{fin:t.fin,rsv1:!1,opcode:i,mask:t.mask,readOnly:c.readOnly}),n)}dispatch(e,t,n,s){if(!t)return void this.sendFrame(l.frame(e,n),s);const r=this._extensions[o.extensionName];this._deflating=!0,r.compress(e,n.fin,(e,t)=>{this._deflating=!1,n.readOnly=!1,this.sendFrame(l.frame(t,n),s),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){const e=this._queue.shift();this._bufferedBytes-=e[1].length,e[0].apply(this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[1].length,this._queue.push(e)}sendFrame(e,t){2===e.length?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}}e.exports=l},1295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n(1296);s.setup();const o=n(14),r=n(1),i=n(1299),a=n(236),c=n(0),l=n(111),d=2e4,h=12e4;class u{constructor(e){this.wsReady=!1,this.reqCounter=1,this.id=e.workerId,this.functionInfo=e.functionInfo,this.setupRequestIdenfiers(),this.setupNetworkMonitorInterceptor(),this.load(),this.setupAdvancedConsole(),this.setupInnerCommunicationServer(),this.setupInspect(),this.setupAutoRefreshEnv(),this.setupInnerWebSocketConnection(e.wsPort,e.wsToken),this.printWelcomeMessage()}load(){let e,t;try{e=require(r.join(this.functionInfo.dir,this.functionInfo.entryFile)),t=e[this.functionInfo.mainHandler]}catch(e){return _("error",l.translate("loadEntryFileFail")),_("error",e),void process.exit(1)}if(this.handler=t,!t)throw new Error(l.translate("functionMustExportMainHandler",this.functionInfo.mainHandler))}setupInnerCommunicationServer(){const e=o.createServer((e,t)=>{g("info",`[worker#${this.id}] receiving a request`);const n=[];e.on("data",e=>n.push(e)).on("end",()=>{const s=Buffer.concat(n).toString(),o=JSON.parse(s);t.on("error",e=>{_("error",`[INTERNAL ERROR] ${l.complexTranslate("errorWhileProcessing",{form:"internalResponse"})}`,e)}),_("info",l.translate("functionTriggeredNotice")),g("info",`[worker#${this.id}] request body received: `,s);const r=+new Date;let i,a=!1,h=d;o.hasOwnProperty("timeoutDuration")&&c.isNumber(o.timeoutDuration)&&(h=o.timeoutDuration),h>0&&(i=setTimeout(()=>{if(!a){a=!0;const e=`function exection timeout (${h/1e3}s)`;console.error(e);const n=new Error(e);t.statusCode=500,t.end(JSON.stringify({name:n.name,message:n.message,stack:n.stack}))}},h));const u=e=>{a||(a=!0,_("error",l.complexTranslate("functionHandlerExecutionResult",{form:"fail",values:[+new Date-r]}),e),clearTimeout(i),e=e instanceof Error?e:new Error(e),t.statusCode=500,t.end(JSON.stringify({name:e.name,message:e.message,stack:e.stack})))},f=e=>{a||(a=!0,_("info",l.complexTranslate("functionHandlerExecutionResult",{form:"success",values:[+new Date-r]}),e),clearTimeout(i),t.end(JSON.stringify(e)))},m={};try{o.env&&p(o.env)&&v(o.env),o.requestId&&(this.requestId=o.requestId),o.callStack&&(this.callStack=o.callStack||[]),"https"===this.functionInfo.triggerType?(t.on("finish",f),this.handler(e,t)):Promise.resolve().then(()=>this.handler(o.data,m)).then(f).catch(u)}catch(e){u(e)}}).on("error",e=>{_("error",`[INTERNAL ERROR] ${l.complexTranslate("errorWhileProcessing",{form:"request"})}`,e)})});e.listen(0,"127.0.0.1",()=>{process.send&&process.send({type:"notify",event:"servicePort",data:e.address().port})})}setupRequestIdenfiers(){const e=this,t=this.id,n=this.functionInfo.id,s=o.request;o.request=function(){let e="",t=void 0;return m(arguments[0])?(e=arguments[0],p(arguments[1])&&(t=arguments[1])):"URL"===f(arguments[0])?(e=arguments[0].href,p(arguments[1])&&(t=arguments[1])):p(arguments[0])&&(t=arguments[0],e=t.path.startsWith("http")?t.path:`${t.protocol||"http"}://${t.hostname||t.host}${80!==t.port?`:${t.port}`:""}${t.path}`),e&&t&&/^http:\/\/tcb-(admin|open|api).tencentcloudapi.com\/admin/.test(e)&&t.method&&"post"===t.method.toLowerCase()&&(p(t.headers)||(t.headers={}),r(t.headers)),s.apply(this,arguments)};const r=s=>{s["X-WORKER-ID"]=t,s["X-FUNCTION-ID"]=n,s["X-CALL-STACK"]=JSON.stringify(e.callStack||[]),s["X-REQUEST-ID"]=e.requestId||"unknown",s["X-ORIGIN-ENV"]=encodeURIComponent(JSON.stringify({WX_APPID:process.env.WX_APPID,WX_API_TOKEN:process.env.WX_API_TOKEN,TCB_SOURCE:process.env.TCB_SOURCE}));const o=`2.${this.reqCounter++}`;console.debug(`~DP_DEBUG_${JSON.stringify({type:"NetworkStackTrace",requestId:o,ignoreDepth:2})}`),s["X-NETWORK-REQUEST-ID"]=o}}setupNetworkMonitorInterceptor(){s.addShouldLogHandler(e=>{if(/^http:\/\/tcb-(admin|open|api).tencentcloudapi.com\/admin/.test(e.url)&&"post"===e.method.toLowerCase()){const t=JSON.parse(e.bodyBuffer.toString());if(t.action.startsWith("database")||t.action.startsWith("functions"))return!1;if("storage.batchDeleteFile"===t.action||"storage.batchGetDownloadUrl"===t.action)return!1}return!0})}setupInspect(){this.functionInfo.inspect&&(process.execArgv.find(e=>"--inspect-brk"===e||"--debug-brk"===e)||i.url()||i.open(0),y())}setupAutoRefreshEnv(){this.autoRefreshEnvTimer=setTimeout(()=>{process.send&&process.send({type:"notify",event:"refreshEnv",data:{tcbSource:process.env.TCB_SOURCE}}),setTimeout(this.setupAutoRefreshEnv.bind(this),h)},h)}setupInnerWebSocketConnection(e,t){g("info","setting up inner websocket",e,t),this.ws=new a(`ws://127.0.0.1:${e}`,t),this.ws.on("open",()=>{this.wsReady=!0,s.networkEvents.on("networkEvent",e=>{g("info","send network event via ws",e),this.ws.send(JSON.stringify({type:"BROADCAST",msgType:"FUNCTION_NETWORK_EVENT",payload:{functionId:this.functionInfo.id,event:{command:"DISPATCH_MESSAGE",data:e}}}))})}),this.ws.on("error",e=>{this.wsReady?_("warn",l.complexTranslate("internalErrorReport",{form:"wsErrorAfterOpen",values:[e]})):_("warn",l.complexTranslate("internalErrorReport",{form:"wsErrorBeforeOpen",values:[e]}))})}setupAdvancedConsole(){console.__baseLog__=function(e,t="log"){"function"==typeof console[t]?console[t](e):console.log(e)}}printWelcomeMessage(){console.group(l.translate("cloudFunctionLocalDebug")),console.log(l.complexTranslate("cloudFunctionLocalDebug",{form:"introduction"})),_("info",l.complexTranslate("doc",{form:"detailed"})+": https://developers.weixin.qq.com/miniprogram/dev/wxcloud/guide/functions/local-debug.html"),_("info",l.translate("networkPanelHint")),"local"===process.env.TCB_ENV?_("info",l.complexTranslate("cloudFunctionLocalDebug",{form:"currentEnvLocal"})):_("info",l.complexTranslate("cloudFunctionLocalDebug",{form:"currentEnvOverride",values:[process.env.TCB_ENV]})),console.groupEnd()}reload(){_("info",l.translate("reloadOnFileChangeHint"));for(const e in require.cache)delete require.cache[e];this.load(),_("info",l.complexTranslate("reloadOnFileChangeHint",{form:"done"}))}}function f(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function p(e){return"object"===f(e)}function m(e){return"string"===f(e)}function _(e,...t){const n=[`%c[${e=e||"info"}]`];"warn"===e?console.warn.apply(console,[...n,"color: blue; font-weight: bold",...t]):"error"===e?console.error.apply(console,[...n,"color: red; font-weight: bold",...t]):console.log.apply(console,[...n,"color: yellowgreen; font-weight: bold",...t])}function g(e,...t){0}function y(){process.send&&process.send({type:"notify",event:"inspectURL",data:i.url()})}function v(e){for(const t in e)"@@DELETE"===e[t]?delete process.env[t]:process.env[t]=e[t];process.env.__CF_ENV_REFRESH_TIME=new Date+""}process.on("uncaughtException",e=>{_("error","Uncaught Exception: ",e)}),process.on("unhandledRejection",(e,t)=>{_("error","Unhandled Rejection at:",t,"reason:",e)}),function(){let e;if(process.on("message",t=>{switch(g(0,global.worker&&global.worker.id),t.type){case"action":!function(t){switch(t.action){case"init":!function(t){if(t.data.locale)switch(t.data.locale){case"zh":case"en":l.setLocale(t.data.locale)}e=global.worker=new u(t.data)}(t);break;case"inspect":!function(e){if(!1!==e.data.enable){if(i.url())return y();i.open(0),y()}else i.close()}(t);break;case"print":!function(e){_(e.data.level||"info",e.data.content)}(t);break;case"reload":e&&e.reload();break;case"refreshEnv":!function(e){e.data.env&&v(e.data.env)}(t)}}(t)}}),!process.send)throw new Error("worker can only be started as a child process");process.send({type:"notify",event:"ready"}),g(0)}()},1296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addShouldLogHandler=t.restore=t.setup=t.networkEvents=void 0;const s=n(14),o=n(18),r=n(1297),i=n(38),a=n(6),c=n(5),l=n(1298),{URL:d}=a;t.networkEvents=new c.EventEmitter;const h=[];let u=0;const f=new Set,p=(e,n)=>{const s=n.request;n.request=function(...o){const r=s.apply(n,o),i=u,a=`1.${u++}`,c=Date.now();let l,d=!0;const h=[],p=r._send.bind(r);r._send=function(...e){const t=e[0],n=e[1];return h.push(Buffer.from(t,n)),p.apply(this,e)};const m=r.end.bind(r);r.end=function(...n){const s=m.apply(this,n);if(d&&"connect"===r.method.toLowerCase())return void(d=!1);const o=r.getHeaders(),i=Buffer.concat(h);l=r.path.startsWith("http")?r.path:`${e}://${o.host}${r.path}`;for(const e of f)try{if(!e({url:l,headers:o,method:r.method,bodyBuffer:i}))return void(d=!1)}catch(e){}const u={method:"Network.requestWillBeSent",params:{requestId:a,documentURL:"https://servicewechat.com",request:{url:l,method:r.method,headers:_(o)},timestamp:c/1e3,type:"XHR"},base64body:i.length?i.toString("base64"):void 0,custom:!0,timestampOffsetRequired:!0};return console.debug(`~DP_DEBUG_${JSON.stringify({type:"NetworkStackTrace",requestId:a,ignoreDepth:1})}`),t.networkEvents.emit("networkEvent",u),s};const w={};r.on("socket",e=>{w.socket=Date.now()-c,e.on("lookup",()=>w.lookup=Date.now()-c),e.on("connect",()=>w.connect=Date.now()-c),e.on("secureConnect",()=>w.secureConnect=Date.now()-c),e.on("error",e=>{d&&v(a,e.toString(),!1)})}),r.on("error",e=>{d&&v(a,e.toString(),!1)});return r.on("response",n=>{if(!d)return;w.response=Date.now()-c,y({stream:n,requestId:a,getResponseHeaders:()=>n.headers}),n.on("error",e=>{d&&v(a,e.toString(),!1)}),n.on("abort",()=>{d&&v(a,"abort",!0)});const s=_(n.headers),o={method:"Network.responseReceived",params:{requestId:a,timestamp:Date.now()/1e3,loaderId:void 0,type:"XHR",response:{url:l,status:n.statusCode,statusText:n.statusMessage,headers:s,requestHeaders:_(r.getHeaders()),mimeType:g(s),encodedDataLength:Number(s["content-length"])||void 0,connectionReused:void 0,securityState:"unknown",connectionId:i,timing:{requestTime:c/1e3,proxyStart:0,proxyEnd:w.socket,dnsStart:w.socket,dnsEnd:w.lookup,connectStart:w.lookup,connectEnd:w.connect,sslStart:"https"===e?w.connect:-1,sslEnd:"https"===e?w.secureConnect:-1,workerStart:-1,workerReady:-1,sendStart:"https"===e?w.secureConnect:w.connect,sendEnd:"https"===e?w.secureConnect:w.connect,pushStart:0,pushEnd:0,receiveHeadersEnd:w.response},protocol:r._header.match(/HTTP\/\d+\.\d+/)[0]}}};t.networkEvents.emit("networkEvent",o)}),r},h.push([n,"request",s])},m=e=>{const n=e.connect.bind(e);e.connect=function(e,s,o){const r=u,i=`1.${u++}`,c=Date.now(),d=e.toString().startsWith("https"),h={socket:0},f=n.apply(null,arguments),p=f.socket;p.on("lookup",()=>h.lookup=Date.now()-c),p.on("connect",()=>h.connect=Date.now()-c),p.on("secureConnect",()=>h.secureConnect=Date.now()-c),p.on("error",e=>{v(i,e.toString(),!1)}),f.on("stream",(n,s,o)=>{const i=`1.${u++}`,c=Date.now(),d=a.resolve(e.toString(),s[":path"]||"/"),h={};let f;n.on("push",(e,t)=>{f=e,h.pushStart=Date.now()/1e3});const p=[];y({stream:n,requestId:i,getResponseHeaders:()=>f,onAutoEmitSuppressed:(e,n)=>{if("end"===e){h.pushEnd=Date.now()/1e3;const e=_(f),o={method:"Network.responseReceived",params:{requestId:i,timestamp:Date.now()/1e3,loaderId:void 0,type:"XHR",response:{url:d,status:f[":status"],statusText:l.statusText[f[":status"]],headers:e,requestHeaders:_(s),mimeType:g(f),encodedDataLength:Number(f["content-length"])||void 0,connectionReused:void 0,securityState:"unknown",connectionId:r,timing:{requestTime:c/1e3,proxyStart:0,proxyEnd:0,dnsStart:-1,dnsEnd:-1,connectStart:-1,connectEnd:-1,sslStart:-1,sslEnd:-1,workerStart:-1,workerReady:-1,sendStart:0,sendEnd:0,pushStart:h.pushStart,pushEnd:h.pushEnd,receiveHeadersEnd:h.pushStart},protocol:"h2"}}};t.networkEvents.emit("networkEvent",o),p.forEach(e=>e()),n()}else"data"===e&&p.push(n)}});const m={method:"Network.requestWillBeSent",params:{requestId:i,documentURL:"https://servicewechat.com",request:{url:d,method:s[":method"],headers:_(s)},timestamp:c/1e3,type:"XHR"},base64body:void 0,custom:!0,timestampOffsetRequired:!0};t.networkEvents.emit("networkEvent",m)});const m=f.request.bind(f);return f.request=function(n,s){const o=m.apply(null,arguments),a=o.sentHeaders,u=e.toString()+(a[":path"]||"/"),f=[],p=o.write.bind(o);o.write=function(...e){try{const t=e[0],n=e[1];"string"==typeof t?f.push(Buffer.from(t,n)):f.push(Buffer.from(t))}catch(e){}return p.apply(this,e)};const w=o.end.bind(o);let b;return o.end=function(...e){const n=w.apply(this,e),s=Buffer.concat(f),o={method:"Network.requestWillBeSent",params:{requestId:i,documentURL:"https://servicewechat.com",request:{url:u,method:a[":method"],headers:_(a)},timestamp:c/1e3,type:"XHR"},base64body:s.length?s.toString("base64"):void 0,custom:!0,timestampOffsetRequired:!0};return console.debug(`~DP_DEBUG_${JSON.stringify({type:"NetworkStackTrace",requestId:i,ignoreDepth:1})}`),t.networkEvents.emit("networkEvent",o),n},o.on("response",(e,n)=>{b=e,h.response=Date.now()-c;const s=_(e),o={method:"Network.responseReceived",params:{requestId:i,timestamp:Date.now()/1e3,loaderId:void 0,type:"XHR",response:{url:u,status:e[":status"],statusText:l.statusText[e[":status"]],headers:s,requestHeaders:_(a),mimeType:g(e),encodedDataLength:Number(e["content-length"])||void 0,connectionReused:void 0,securityState:"unknown",connectionId:r,timing:{requestTime:c/1e3,proxyStart:0,proxyEnd:h.socket,dnsStart:h.socket,dnsEnd:h.lookup,connectStart:h.lookup,connectEnd:h.connect,sslStart:d?h.connect:-1,sslEnd:d?h.secureConnect:-1,workerStart:-1,workerReady:-1,sendStart:d?h.secureConnect:h.connect,sendEnd:d?h.secureConnect:h.connect,pushStart:0,pushEnd:0,receiveHeadersEnd:h.response},protocol:"h2"}}};t.networkEvents.emit("networkEvent",o)}),y({stream:o,requestId:i,getResponseHeaders:()=>b}),o.on("error",e=>{v(i,e.toString(),!1)}),o.on("aborted",e=>{v(i,e.toString(),!1)}),o},f}};t.setup=()=>{p("http",s),p("https",o),m(r)};t.restore=()=>{h&&h.forEach(([e,t,n])=>e[t]=n)};function _(e){const t={};for(const n in e){const s=e[n];if(s){const o=Object.prototype.toString.call(e[n]);t[n]="[object Array]"===o?s.join("\n"):s+""}}return t}function g(e){if(!e)return"text/plain";const t=["Content-Type","content-type","Content-type","content-Type"];for(const n of t)if("string"==typeof e[n]){return e[n].split(";")[0]}return"text/plain"}function y(e){const{stream:n,requestId:s,getResponseHeaders:o,onAutoEmitSuppressed:r}=e,a=[],c=[];n.on("data",e=>{Buffer.isBuffer(e)?e.length&&a.push(e):c.push(e);const n=()=>{const n={method:"Network.dataReceived",params:{requestId:s,timestamp:Date.now()/1e3,dataLength:e.length,encodedDataLength:e.length},custom:!0,timestampOffsetRequired:!0};t.networkEvents.emit("networkEvents",n)};r?r("data",n):n()}),n.on("end",()=>{let e,n;if(a.length){e=Buffer.concat(a);const t=(o()["content-encoding"]||"identity").trim().toLowerCase(),s={flush:i.Z_SYNC_FLUSH,finishFlush:i.Z_SYNC_FLUSH};n="gzip"===t?i.unzipSync(e,s):"deflate"===t?i.inflateSync(e,s):"br"===t?i.brotliDecompressSync(e,s):e}else e=Buffer.from(c.join("")),n=e;const l=()=>{const o={method:"Network.loadingFinished",params:{requestId:s,timestamp:Date.now()/1e3,encodedDataLength:e.length},base64body:n.toString("base64"),custom:!0,timestampOffsetRequired:!0};t.networkEvents.emit("networkEvent",o)};r?r("end",l):l()})}function v(e,n,s){const o={method:"Network.loadingFailed",params:{requestId:e,timestamp:Date.now()/1e3,type:"XHR",errorText:n,canceled:s}};t.networkEvents.emit("networkEvent",o)}t.addShouldLogHandler=e=>(f.add(e),()=>{f.delete(e)})},1297:function(e,t){e.exports=require("http2")},1298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.statusText=void 0,t.statusText={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",427:"Unassigned",428:"Precondition Required",429:"Too Many Requests",430:"Unassigned",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Unassigned",510:"Not Extended",511:"Network Authentication Required"}},1299:function(e,t){e.exports=require("inspector")},14:function(e,t){e.exports=require("http")},17:function(e,t){e.exports=require("net")},18:function(e,t){e.exports=require("https")},234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={cloudFunctionLocalDebug:{en:{defaults:"Cloud Functions Local Debug",introduction:"Cloud Functions Local Debug tightly integrates with miniprogram simulator, the requests from IDE miniprogram will arrive here instead of cloud, and you can take advantage of breakpoint debugging and other capabilities here. In the meantime, local debugger also supports triggering through the control panel to the right",currentEnvLocal:"Current cloud.DYNAMIC_CURRENT_ENV is effectively the default environment (first environment created).",currentEnvOverride:"Current cloud.DYNAMIC_CURRENT_ENV: %s"},zh:{defaults:"云函数本地调试",introduction:"云函数本地调试和小程序模拟器深度集成，从开发者工具小程序发起的对该云函数的请求均会到此而不是云端，可进行断点调试等操作，同时也支持从右侧控制面板输入 JSON 模板触发云函数",currentEnvLocal:"当前 cloud.DYNAMIC_CURRENT_ENV 相当于默认环境（第一个创建的环境）",currentEnvOverride:"当前 cloud.DYNAMIC_CURRENT_ENV：%s"}},doc:{en:{defaults:"Documentation",detailed:"Detailed Documentation"},zh:{defaults:"文档",detailed:"详细文档"}},functionMustExportMainHandler:{en:{defaults:"function module must export the handler of name '%s'"},zh:{defaults:"函数必须导出名为 '%s' 的方法"}},errorWhileProcessing:{en:{defaults:"",internalResponse:"encounter an error while processing internal response",request:"encounter an error while processing a request"},zh:{defaults:"",internalResponse:"在处理内部响应时遇到错误",request:"在处理一个请求时遇到错误"}},functionTriggeredNotice:{en:{defaults:"function is triggered, starting execution...",concurrentWaitWarning:"%s requests pending execution (in local debug mode, only 1 local cloud function instance is running and requests are executed sequentially)"},zh:{defaults:"函数被触发，正在执行中...",concurrentWaitWarning:"%s 个请求正在等待执行（在本地调试中，每个云函数有一个本地实例，请求串行执行）"}},functionHandlerExecutionResult:{en:{defaults:"",fail:"function execution fail (cost %sms)",success:"function execution success (cost %sms)"},zh:{defaults:"",fail:"函数执行失败（耗时 %sms）",success:"函数执行成功（耗时 %sms）"}},callGraphResult:{en:{defaults:"",title:"the call to %s function '%s' has finished",timeCost:"(cost %sms)",itsCallGraph:"its call graph",notice:"Be aware: call graph of online cloud function couldn't be displayed, that is to say, if there're any function calls from within a online cloud function, they won't appear in the above call graph."},zh:{defaults:"",title:"调用 %s 云函数 '%s' 完成",timeCost:"（耗时 %sms）",itsCallGraph:"调用图",notice:"注意: 此处不包含云端云函数端发起的调用，也就是说，如果云端云函数发起了对其他云函数的调用，在上图中将不会展现。"}},recursiveCallDetection:{en:{defaults:"Recursive function call detected! Recursive call is prohibited by default in local debugger because recursive function call may lead to infinite recursion in production, please use with caution. \n\nThe call stack: \n\n%s\n\n"},zh:{defaults:"检测到循环调用！在本地调试中云函数递归调用是被默认禁止的，云函数递归调用可能导致死循环问题，因此请谨慎使用。调用栈：\n\n%s\n\n"}},reloadOnFileChangeHint:{en:{defaults:"Local file changed, reloading function...",done:"Function reload done."},zh:{defaults:"检测到本地文件变更，重新载入函数中...",done:"函数重载完成"}},punctuation:{en:{defaults:"",wordSeparator:"",comma:",",colon:":"},zh:{defaults:"",wordSeparator:" ",comma:"，",colon:"："}},local:{en:{defaults:"local"},zh:{defaults:"本地"}},remote:{en:{defaults:"cloud"},zh:{defaults:"云端"}},templateResource:{en:{defaults:""},zh:{defaults:""}},internalErrorReport:{en:{defaults:"",wsErrorBeforeOpen:"internal error (do not obstruct debugging): inner ws errored before open, network panel cannot be used normally: %s",wsErrorAfterOpen:"internal error (do not obstruct debugging): inner ws errored after opened, network panel cannot be used normally: %s"},zh:{defaults:"",wsErrorBeforeOpen:"内部错误（不影响正常调试）: 内部通信建立错误，Network 面板无法正常使用: %s",wsErrorAfterOpen:"内部错误（不影响正常调试）: 内部通信建立后错误，Network 面板无法正常使用: %s"}},networkPanelHint:{en:{defaults:"Network Panel is supported now, you can view network requests and cloudbase requests in network panel"},zh:{defaults:"本地调试已支持 Network 面板，可以在 Network 面板查看网络请求和云开发请求"}},loadEntryFileFail:{en:{defaults:"Load & execute entry file failed, error:"},zh:{defaults:"加载执行入口文件失败，错误如下"}}}},236:function(e,t,n){"use strict";const s=n(112);s.Server=n(239),s.Receiver=n(114),s.Sender=n(116),e.exports=s},237:function(e,t,n){"use strict";function s(e){if(!(this instanceof s))return new s(e);e=e||{},this.concurrency=e.concurrency||1/0,this.pending=0,this.jobs=[],this.cbs=[],this._done=o.bind(this)}function o(){this.pending--,this._run()}["push","unshift","splice"].forEach((function(e){s.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this._run(),t}})),Object.defineProperty(s.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),s.prototype._run=function(){if(this.pending!==this.concurrency){if(this.jobs.length){var e=this.jobs.shift();this.pending++,e(this._done),this._run()}if(0===this.pending)for(;0!==this.cbs.length;){var t=this.cbs.pop();process.nextTick(t)}}},s.prototype.onDone=function(e){"function"==typeof e&&(this.cbs.push(e),this._run())},e.exports=s},238:function(e,t,n){"use strict";class s{constructor(e,t){this.target=t,this.type=e}}class o extends s{constructor(e,t){super("message",t),this.data=e}}class r extends s{constructor(e,t,n){super("close",n),this.wasClean=n._closeFrameReceived&&n._closeFrameSent,this.reason=t,this.code=e}}class i extends s{constructor(e){super("open",e)}}class a extends s{constructor(e,t){super("error",t),this.message=e.message,this.error=e}}const c={addEventListener(e,t){function n(e){t.call(this,new o(e,this))}function s(e,n){t.call(this,new r(e,n,this))}function c(e){t.call(this,new a(e,this))}function l(){t.call(this,new i(this))}"function"==typeof t&&("message"===e?(n._listener=t,this.on(e,n)):"close"===e?(s._listener=t,this.on(e,s)):"error"===e?(c._listener=t,this.on(e,c)):"open"===e?(l._listener=t,this.on(e,l)):this.on(e,t))},removeEventListener(e,t){const n=this.listeners(e);for(var s=0;s<n.length;s++)n[s]!==t&&n[s]._listener!==t||this.removeListener(e,n[s])}};e.exports=c},239:function(e,t,n){"use strict";const s=n(5),o=n(3),r=n(14),i=n(55),a=n(113),c=n(112),{GUID:l}=n(35),d=/^[+/0-9A-Za-z]{22}==$/;function h(e){e.emit("close")}function u(){this.destroy()}function f(e,t,n,s){e.writable&&(n=n||r.STATUS_CODES[t],s=Object.assign({Connection:"close","Content-type":"text/html","Content-Length":Buffer.byteLength(n)},s),e.write(`HTTP/1.1 ${t} ${r.STATUS_CODES[t]}\r\n`+Object.keys(s).map(e=>`${e}: ${s[e]}`).join("\r\n")+"\r\n\r\n"+n)),e.removeListener("error",u),e.destroy()}e.exports=class extends s{constructor(e,t){if(super(),null==(e=Object.assign({maxPayload:104857600,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},e)).port&&!e.server&&!e.noServer)throw new TypeError('One of the "port", "server", or "noServer" options must be specified');null!=e.port?(this._server=r.createServer((e,t)=>{const n=r.STATUS_CODES[426];t.writeHead(426,{"Content-Length":n.length,"Content-Type":"text/plain"}),t.end(n)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server&&(this._removeListeners=function(e,t){for(const n of Object.keys(t))e.on(n,t[n]);return function(){for(const n of Object.keys(t))e.removeListener(n,t[n])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(e,t,n)=>{this.handleUpgrade(e,t,n,t=>{this.emit("connection",t,e)})}})),!0===e.perMessageDeflate&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set),this.options=e}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(e&&this.once("close",e),this.clients)for(const e of this.clients)e.terminate();const t=this._server;t&&(this._removeListeners(),this._removeListeners=this._server=null,null!=this.options.port)?t.close(()=>this.emit("close")):process.nextTick(h,this)}shouldHandle(e){if(this.options.path){const t=e.url.indexOf("?");if((-1!==t?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,s){t.on("error",u);const o=void 0!==e.headers["sec-websocket-key"]&&e.headers["sec-websocket-key"].trim(),r=+e.headers["sec-websocket-version"],c={};if("GET"!==e.method||"websocket"!==e.headers.upgrade.toLowerCase()||!o||!d.test(o)||8!==r&&13!==r||!this.shouldHandle(e))return f(t,400);if(this.options.perMessageDeflate){const n=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{const t=a.parse(e.headers["sec-websocket-extensions"]);t[i.extensionName]&&(n.accept(t[i.extensionName]),c[i.extensionName]=n)}catch(e){return f(t,400)}}if(this.options.verifyClient){const i={origin:e.headers[`${8===r?"sec-websocket-origin":"origin"}`],secure:!(!e.connection.authorized&&!e.connection.encrypted),req:e};if(2===this.options.verifyClient.length)return void this.options.verifyClient(i,(r,i,a,l)=>{if(!r)return f(t,i||401,a,l);this.completeUpgrade(o,c,e,t,n,s)});if(!this.options.verifyClient(i))return f(t,401)}this.completeUpgrade(o,c,e,t,n,s)}completeUpgrade(e,t,n,s,r,d){if(!s.readable||!s.writable)return s.destroy();const h=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${o.createHash("sha1").update(e+l).digest("base64")}`],f=new c(null);var p=n.headers["sec-websocket-protocol"];if(p&&(p=p.trim().split(/ *, */),(p=this.options.handleProtocols?this.options.handleProtocols(p,n):p[0])&&(h.push(`Sec-WebSocket-Protocol: ${p}`),f.protocol=p)),t[i.extensionName]){const e=t[i.extensionName].params,n=a.format({[i.extensionName]:[e]});h.push(`Sec-WebSocket-Extensions: ${n}`),f._extensions=t}this.emit("headers",h,n),s.write(h.concat("\r\n").join("\r\n")),s.removeListener("error",u),f.setSocket(s,r,this.options.maxPayload),this.clients&&(this.clients.add(f),f.on("close",()=>this.clients.delete(f))),d(f)}}},3:function(e,t){e.exports=require("crypto")},35:function(e,t,n){"use strict";e.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),EMPTY_BUFFER:Buffer.alloc(0),NOOP:()=>{}}},38:function(e,t){e.exports=require("zlib")},4:function(e,t){e.exports=require("stream")},5:function(e,t){e.exports=require("events")},55:function(e,t,n){"use strict";const s=n(237),o=n(38),r=n(69),{kStatusCode:i,NOOP:a}=n(35),c=Buffer.from([0,0,255,255]),l=Buffer.from([0]),d=Symbol("permessage-deflate"),h=Symbol("total-length"),u=Symbol("callback"),f=Symbol("buffers"),p=Symbol("error");let m;function _(e){this[f].push(e),this[h]+=e.length}function g(e){this[h]+=e.length,this[d]._maxPayload<1||this[h]<=this[d]._maxPayload?this[f].push(e):(this[p]=new RangeError("Max payload size exceeded"),this[p][i]=1009,this.removeListener("data",g),this.reset())}function y(e){this[d]._inflate=null,e[i]=1007,this[u](e)}e.exports=class{constructor(e,t,n){if(this._maxPayload=0|n,this._options=e||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!m){const e=void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10;m=new s({concurrency:e})}}static get extensionName(){return"permessage-deflate"}offer(){const e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate&&(this._deflate.close(),this._deflate=null)}acceptAsServer(e){const t=this._options,n=e.find(e=>!(!1===t.serverNoContextTakeover&&e.server_no_context_takeover||e.server_max_window_bits&&(!1===t.serverMaxWindowBits||"number"==typeof t.serverMaxWindowBits&&t.serverMaxWindowBits>e.server_max_window_bits)||"number"==typeof t.clientMaxWindowBits&&!e.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),"number"==typeof t.serverMaxWindowBits&&(n.server_max_window_bits=t.serverMaxWindowBits),"number"==typeof t.clientMaxWindowBits?n.client_max_window_bits=t.clientMaxWindowBits:!0!==n.client_max_window_bits&&!1!==t.clientMaxWindowBits||delete n.client_max_window_bits,n}acceptAsClient(e){const t=e[0];if(!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(t.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(t.client_max_window_bits=this._options.clientMaxWindowBits);return t}normalizeParams(e){return e.forEach(e=>{Object.keys(e).forEach(t=>{var n=e[t];if(n.length>1)throw new Error(`Parameter "${t}" must have only a single value`);if(n=n[0],"client_max_window_bits"===t){if(!0!==n){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}else if("server_max_window_bits"===t){const e=+n;if(!Number.isInteger(e)||e<8||e>15)throw new TypeError(`Invalid value for parameter "${t}": ${n}`);n=e}else{if("client_no_context_takeover"!==t&&"server_no_context_takeover"!==t)throw new Error(`Unknown parameter "${t}"`);if(!0!==n)throw new TypeError(`Invalid value for parameter "${t}": ${n}`)}e[t]=n})}),e}decompress(e,t,n){m.push(s=>{this._decompress(e,t,(e,t)=>{s(),n(e,t)})})}compress(e,t,n){m.push(s=>{this._compress(e,t,(e,t)=>{s(),n(e,t)})})}_decompress(e,t,n){const s=this._isServer?"client":"server";if(!this._inflate){const e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?o.Z_DEFAULT_WINDOWBITS:this.params[e];this._inflate=o.createInflateRaw(Object.assign({},this._options.zlibInflateOptions,{windowBits:t})),this._inflate[d]=this,this._inflate[h]=0,this._inflate[f]=[],this._inflate.on("error",y),this._inflate.on("data",g)}this._inflate[u]=n,this._inflate.write(e),t&&this._inflate.write(c),this._inflate.flush(()=>{const e=this._inflate[p];if(e)return this._inflate.close(),this._inflate=null,void n(e);const o=r.concat(this._inflate[f],this._inflate[h]);t&&this.params[`${s}_no_context_takeover`]?(this._inflate.close(),this._inflate=null):(this._inflate[h]=0,this._inflate[f]=[]),n(null,o)})}_compress(e,t,n){if(!e||0===e.length)return void process.nextTick(n,null,l);const s=this._isServer?"server":"client";if(!this._deflate){const e=`${s}_max_window_bits`,t="number"!=typeof this.params[e]?o.Z_DEFAULT_WINDOWBITS:this.params[e];this._deflate=o.createDeflateRaw(Object.assign({},this._options.zlibDeflateOptions,{windowBits:t})),this._deflate[h]=0,this._deflate[f]=[],this._deflate.on("error",a),this._deflate.on("data",_)}this._deflate.write(e),this._deflate.flush(o.Z_SYNC_FLUSH,()=>{if(this._deflate){var e=r.concat(this._deflate[f],this._deflate[h]);t&&(e=e.slice(0,e.length-4)),t&&this.params[`${s}_no_context_takeover`]?(this._deflate.close(),this._deflate=null):(this._deflate[h]=0,this._deflate[f]=[]),n(null,e)}})}}},6:function(e,t){e.exports=require("url")},67:function(e,t){e.exports=require("tls")},69:function(e,t,n){"use strict";const{EMPTY_BUFFER:s}=n(35);function o(e,t){if(0===e.length)return s;if(1===e.length)return e[0];const n=Buffer.allocUnsafe(t);for(var o=0,r=0;r<e.length;r++){const t=e[r];t.copy(n,o),o+=t.length}return n}function r(e,t,n,s,o){for(var r=0;r<o;r++)n[s+r]=e[r]^t[3&r]}function i(e,t){const n=e.length;for(var s=0;s<n;s++)e[s]^=t[3&s]}function a(e){return e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}function c(e){return c.readOnly=!0,Buffer.isBuffer(e)?e:(e instanceof ArrayBuffer?t=Buffer.from(e):ArrayBuffer.isView(e)?t=function(e){const t=Buffer.from(e.buffer);if(e.byteLength!==e.buffer.byteLength)return t.slice(e.byteOffset,e.byteOffset+e.byteLength);return t}(e):(t=Buffer.from(e),c.readOnly=!1),t);var t}try{const t=n(!function(){var e=new Error("Cannot find module 'bufferutil'");throw e.code="MODULE_NOT_FOUND",e}()),s=t.BufferUtil||t;e.exports={concat:o,mask(e,t,n,o,i){i<48?r(e,t,n,o,i):s.mask(e,t,n,o,i)},toArrayBuffer:a,toBuffer:c,unmask(e,t){e.length<32?i(e,t):s.unmask(e,t)}}}catch(t){e.exports={concat:o,mask:r,toArrayBuffer:a,toBuffer:c,unmask:i}}}});