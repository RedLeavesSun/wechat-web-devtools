!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=86)}([function(e,t,o){var n=o(15);t=Object.keys?Object.keys:function(e){var t=[];for(var o in e)n(e,o)&&t.push(o);return t},e.exports=t},function(e,t){var o=Object.prototype.toString;t=function(e){return o.call(e)},e.exports=t},function(e,t,o){"use strict";const n=window.navigator||window.__global.navigator,r=window.WebSocket||window.__global.WebSocket,s=window.prompt||window.__global.prompt,a=n.userAgent.match(/port\/(\d*)/),i=a?parseInt(a[1]):9974,c="ws://127.0.0.1:"+i;window.__maxConnectTryTime=10;e.exports=class{constructor(e,t=!0){this._protocol=e,this._needToken=t,this._ws=null,this._msgQueue=[],this._callback=new Set,this._parseJson=null,this.tryTime=0,"complete"===document.readyState?setTimeout(()=>{this.connect()}):window.addEventListener("load",()=>{this.connect()})}connect(){if(!i)return;if(this.tryTime++,this.tryTime>=window.__maxConnectTryTime)return void console.error("当前应用通道断开且重连次数已满，请重新编译应用");let e=this._protocol;if(this._needToken){e=`${e}#${s("GET_MESSAGE_TOKEN")}#`}this._ws=new r(c,e),this._ws.onopen=()=>{const e=[].concat(this._msgQueue);this._msgQueue=[],e.forEach(e=>{this.send(e)})},this._ws.onclose=()=>{this._ws=null,setTimeout(()=>{this.connect()},150)},this._ws.onmessage=e=>{try{const t=this._parseJson?this._parseJson(e.data):JSON.parse(e.data);this._callback.forEach(e=>{try{e.call(this,t)}catch(e){}})}catch(e){}}}send(e){this._ws&&this._ws.readyState===r.OPEN?this._ws.send(JSON.stringify(e)):this._msgQueue.push(e)}registerCallback(e){"function"==typeof e&&this._callback.add(e)}removeCallback(e){this._callback.delete(e)}}},function(e,t,o){var n=o(1);t=Array.isArray?Array.isArray:function(e){return"[object Array]"===n(e)},e.exports=t},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(5),r=n.navigator.userAgent,s=o(2);let a,i=!1,c=!1;const l=()=>{if(a)return a;let e="APPSERVICE";return/widgetservice/.test(r)?e="WIDGETSERVICE":/gameservice/.test(r)?e="GAMESERVICE":/ibservice/.test(r)&&(e="IBSERVICE"),a=new s(e),/gameservice/.test(r)&&a.registerCallback(e=>{const{command:t,data:o}=e;if("SET_CANVAS"===t){const e=n.document.getElementById("myCanvas");e.setAttribute("width",o.width),e.setAttribute("height",o.height),e.setAttribute("style",o.style)}}),a},u=new Set;let d=[];const g=e=>{u.forEach(t=>{try{t(e)}catch(e){}})},f=e=>{if(c)g(e);else{const{command:t}=e;switch(t){case"APPSERVICE_INVOKE_EMITTER":case"APPSERVICE_ON_EVENT":case"WEBVIEW_PUBLISH":d.push(e);break;default:g(e)}}};function p(e){l().send(e)}t.send=p,t.registerCallback=function(e){if(u.add(e),!i){l().registerCallback(f),i=!0}},t.removeCallback=function(e){if(u.delete(e),!i){l().registerCallback(f),i=!0}},t.setAppserviceReady=function(e,t){if(c===e)return;c=e,l()._parseJson=t,e&&(d.forEach(e=>g(e)),d=[])},window.__global.messager={send:p}},function(e,t,o){"use strict";e.exports=window.__global},function(e,t){t=function(e){return void 0===e},e.exports=t},function(e,t,o){var n=o(1);t=function(e){var t=n(e);return"[object Function]"===t||"[object GeneratorFunction]"===t||"[object AsyncFunction]"===t},e.exports=t},function(e,t,o){"use strict";const n=o(28);class r extends n.EventEmitter{constructor(){super(),this.instanceScopeListeners=new Set,this.instanceScope=()=>({on:(e,t)=>(this.on(e,t),this.instanceScopeListeners.add({event:e,fn:t}),this),once:(e,t)=>(this.once(e,t),this.instanceScopeListeners.add({event:e,fn:t}),this),off:this.off.bind(this)}),this.initAutoClean()}initAutoClean(){this.on("RESET_INSTANCE",()=>{for(const{event:e,fn:t}of this.instanceScopeListeners)this.off(e,t);this.instanceScopeListeners.clear()})}}e.exports=new r},function(e,t,o){"use strict";window.__devtoolsConfig||(window.__devtoolsConfig={setting:{}}),window.__wxConfig=window.__wxConfig||{};const n={getSystemInfo:!0,getBatteryInfo:!0,getBackgroundAudioState:!0,setBackgroundAudioState:!0,operateBackgroundAudio:!0,createRequestTask:!0,createUploadTask:!0,createDownloadTask:!0,createSocketTask:!0,operateSocketTask:!0,createAudioInstance:!0,getMenuButtonBoundingClientRect:!0,getPermissionBytes:!0,getPluginPermissionBytes:!0,createUDPSocket:!0,bindUDPSocket:!0,createLockStep:!0,loadFont:!0,canIUse:!0,createBufferURL:!0,revokeBufferURL:!0,measureTextString:!0,readCompressedFileSync:!0,injectSubPackages:!0,loadComponents:!0,createTCPServer:!0,listenTCPServer:!0,createTCPSocket:!0,connectTCPSocket:!0,writeTCPSocket:!0};let r=0;e.exports={syncSDKList:n,isSyncSDK:function(e){return!!n[e]||/Sync$/.test(e)},get DevtoolsConfig(){return __devtoolsConfig},get NetworkConfig(){return(null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.network)||{}},get Permission(){return null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.permission},get AppserviceMaxDataSize(){return(null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.setting)&&__devtoolsConfig.setting.MaxDataSize||1048576},get MaxRequestConcurrent(){return(null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.setting)&&__devtoolsConfig.setting.MaxRequestConcurrent||10},get MaxWebsocketConnect(){return(null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.setting)&&__devtoolsConfig.setting.MaxWebsocketConnect||10},get isUseApiMock(){return(null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.useApiMock)||!1},get apiMockApiList(){return(null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.apiList)||{}},get libNumberVersion(){var e;return null!==(e=null===__devtoolsConfig||void 0===__devtoolsConfig?void 0:__devtoolsConfig.libNumberVersion)&&void 0!==e?e:999999999},ibForbiddenApi:{navigateTo:!0,navigateBack:!0,redirectTo:!0,switchTab:!0,reLaunch:!0,updateApp:!0,openUrl:!0,restart:!0,showTabBar:!0,hideTabBar:!0,openAddress:!0,addPhoneContact:!0,showActionSheet:!0,showToast:!0,hideToast:!0,showModal:!0,showLoading:!0,shareAppMessage:!0,showShareMenuWithShareTicket:!0,showShareMenu:!0,hideShareMenu:!0,shareAppMessageDirectly:!0,showShareTimelineMenu:!0,hideShareTimelineMenu:!0,openSetting:!0},urlCheckErrReason:"url not in domain list",needTransArgsBase64Api:{createBufferURL:!0},canNotReadFromCodePackage:{js:!0,wxss:!0,wxml:!0},genIdForDevTools:function(e,t){if("operateWXData"===e&&t&&"qbase_commapi"===t.apiName&&t.data&&t.data.data)switch(t.data.data.qbase_api_name){case"tcbapi_db_adddocument":case"tcbapi_db_deletedocument":case"tcbapi_db_querydocument":case"tcbapi_db_updatedocument":case"tcbapi_db_setdocument":case"tcbapi_db_countdocument":case"tcbapi_db_aggregate":case"tcbapi_deletefile":case"tcbapi_gettempfileurl":{const e="4."+r++;return console.debug("~DP_DEBUG_"+JSON.stringify({type:"NetworkStackTrace",requestId:e,ignoreDepth:2})),e}}},invokeNeedToDevtoolsApi:{request:"request",createRequestTask:"request",operateRequestTask:"request"},actionsConfig:{SIMULATOR_SET_BACKGROUND_AUDIO:"SIMULATOR_SET_BACKGROUND_AUDIO",TOOLBAR_SET_CLICKKEY:"TOOLBAR_SET_CLICKKEY"},musicStatusConfig:{MUSIC_STATE_INIT:1,MUSIC_STATE_PLAY:2,MUSIC_STATE_PAUSE:3,MUSIC_STATE_END:4,MUSIC_STATE_ERROR:5},referrerConfig:{referrerPolicyOrigin:"#devtools_refererOrigin",referrerPolicyNoReferrer:"#devtools_no_referrer"},clickkeyConfig:{MUSICCARD:"musiccard"}}},function(e,t,o){var n=o(16),r=o(0),s=o(14);t=function(e,t,o){var a,i;if(t=s(t,o),n(e))for(a=0,i=e.length;a<i;a++)t(e[a],a,e);else{var c=r(e);for(a=0,i=c.length;a<i;a++)t(e[c[a]],c[a],e)}return e},e.exports=t},,function(e,t,o){"use strict";const n=o(46),r=o(9),s=o(5);let a=!1,i=[];window.showDebugInfo=(e,t)=>{const o=i.filter(o=>{const n=!e||(Array.isArray(e)?e.includes(o.type):o.type===e),r=!t||(Array.isArray(t)?t.includes(o.eventName):o.eventName===t);if(n&&r)return o});console.group("showDebugInfo"),o.forEach(e=>{console.group(`${e.timesmap} WeixinJSBridge ${e.type} ${e.eventName}`),console.debug.apply(window,e.data),console.groupEnd()}),console.groupEnd(),a=!0};const c=()=>(console.clear(),void(a=!1));Object.defineProperty(window,"closeDebug",{get:()=>c});const l=()=>{console.table(i)};Object.defineProperty(window,"showDebugInfoTable",{get:()=>l});function u(e){const t=s.atob(e),o=t.length,n=new Uint8Array(o);for(let e=0;e<o;e++)n[e]=t.charCodeAt(e);return n.buffer}function d(e,t="`"){return e?"`"===t?e.replace(/\\/g,"\\\\").replace(/`/g,"\\`").replace(/\$/g,"\\$"):'"'===t?e.replace(/\\/g,"\\\\").replace(/\r\n/g,"\n").replace(/\n/g,"\\n").replace(/"/g,'\\"'):"'"===t?e.replace(/\\/g,"\\\\").replace(/\r\n/g,"\n").replace(/\n/g,"\\n").replace(/'/g,"\\'"):e:e}const g=e=>{const t=/^(?:http|ws)s?:\/\/((?:\d{1,3}\.){3}\d{1,3})(?::\d{1,5})?/i.exec(e);if(t){const{localhostIp:e,networkMask:o}=r.DevtoolsConfig;if(!e||!o)return!1;const n=t[1];return e.split(".").map((e,t)=>e&o[t]).join(".")===n.split(".").map((e,t)=>e&o[t]).join(".")}return!1},f=/^(http|ws|udp)s?:\/\/[\w-.]+(:\d+)?/i;let p=!0;window.__disPlayURLCheckWarning=!0;const m=e=>{const t=/^(?:http|ws)s?:\/\/((?:\d{1,3}\.){3}\d{1,3})(?::\d{1,5})?/i.exec(e);if(t){return t[1]===r.DevtoolsConfig.localhostIp}return!1};e.exports={debugLog:(e,t)=>{a&&(console.group(e),console.debug.apply(null,t),console.groupEnd())},debugInfo:e=>{a||(i.length>100&&(i=[]),i.push(e))},isDev:()=>a,base64ToArrayBuffer:u,arrayBufferToBase64:function(e){let t="";const o=new Uint8Array(e),n=o.byteLength;for(let e=0;e<n;e++)t+=String.fromCharCode(o[e]);return s.btoa(t)},escapeQuot:d,isKindOfArrayBuffer:function(e){if(!e)return!1;if(e instanceof ArrayBuffer)return!0;try{const t=Object.getPrototypeOf(e);return!(!t.hasOwnProperty("byteLength")||"[object ArrayBuffer]"!==Object.prototype.toString.call(t))}catch(e){return!1}},isKindOfArray:function(e){if(!e)return!1;if(e instanceof Array)return!0;if(Array.isArray(e))return!0;try{const t=e.length;if("number"!=typeof t)return!1;for(let o=0;o<t;o++)if(!(o in e))return!1;return!0}catch(e){return!1}},checkUrl:(e,t="request")=>{if(n.isTourist())return p&&(console.group(new Date+" 无 AppID 关联"),console.warn("工具未检查合法域名，更多请参考文档：https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html"),console.groupEnd(),p=!1),!0;if(!r.DevtoolsConfig.urlCheck)return window.__disPlayURLCheckWarning&&(console.group(new Date+" 配置中关闭合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书检查"),console.warn("工具未校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书。"),console.groupEnd(),window.__disPlayURLCheckWarning=!1),!0;if(!e)return!1;if(/(\?|&)skip_domain_check=true(&|$)/.test(e))return!0;if(["request","downloadFile","uploadFile","socket","udp"].includes(t)){if(m(e))return setTimeout(()=>{console.error("Cannot send network request to localhost.")}),!1;if(g(e))return!0}if(!(e=f.exec(e.toLowerCase())))return!1;e=e[0];if(/^http:\/\/(tmp|usr|store)\/?$/gi.test(e))return!0;try{const o={downloadFile:r.NetworkConfig.download,uploadFile:r.NetworkConfig.upload,socket:r.NetworkConfig.socket,udp:r.NetworkConfig.udp}[t]||r.NetworkConfig.request;for(const n of o){const o=f.exec(n.toLowerCase());if(o&&o[0]===e)return!0;if("socket"===t&&r.DevtoolsConfig.setting.WebsocketSkipPortCheck){if(new RegExp(`^${n}(:\\d+)?$`).test(e))return!0}}const n=[];o.forEach(e=>{n.push([e])}),console.group(`${new Date} ${t} 合法域名校验出错`),console.info("如若已在管理后台更新域名配置，请刷新项目配置后重新编译项目，操作路径：“详情-域名信息”"),console.error(` ${d(e,"`")} 不在以下 ${t} 合法域名列表中，请参考文档：https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html`),console.table(n),console.groupEnd()}catch(e){return console.error(e),!1}return!1},isLocalhost:m,isInLAN:g,coverRes:e=>{if(null==e?void 0:e.__cover){for(const t in e.__cover)if("base64"===t&&(e[e.__cover[t]]=u(e.base64),delete e.base64),"base64Array"===t&&(e[e.__cover[t]]=e.base64Array.map(e=>u(e)),delete e.base64Array),"base64Entries"===t){const o=e.__cover[t]||[];for(const t of o)e[t.key]=u(t.base64);delete e.base64Entries}delete e.__cover}},coverResToOriginArgs:(e,t)=>{if(null==e?void 0:e.__toOrigin)for(const o in e.__toOrigin){const n=e.__toOrigin[o],r=t[n.argsName],s=e[o];if(s&&r&&"ArrayBuffer"===n.type){const t=new Uint8Array(r),n=new Uint8Array(s),a=t.length;for(let e=0;e<a;e++)t[e]=n[e];e[o]=r}}delete e.__toOrigin},evaluateRes:function(e){var t,o;if(!e.__codes)return;const n=e.__codes,r=window.__global.asLoader;let s=null;if(r){const e=r.frames.get(r.currentFrameId);s=null!==(o=null===(t=e.iframe.contentWindow.__global.asSubLoader)||void 0===t?void 0:t.activeAppDocument)&&void 0!==o?o:e.iframe.contentDocument}else s=window.document;for(let e=0,t=n.length;e<t;e++){const t=s.createElement("script");t.text=n[e],s.head.appendChild(t)}},calibration:()=>{try{const e=new s.XMLHttpRequest;e.responseType="text",e.open("GET",`${location.protocol}//${window.location.host}/calibration/${Date.now()}`,!0),e.send()}catch(e){}},getQueryString:function(e){var t=new RegExp(`(^|&)${e}=([^&]*)(&|$)`,"i"),o=window.location.search.substr(1).match(t);return null!=o?unescape(o[2]):null}}},function(e,t){t=function(e){var t=typeof e;return!!e&&("function"===t||"object"===t)},e.exports=t},function(e,t,o){var n=o(6);t=function(e,t,o){if(n(t))return e;switch(null==o?3:o){case 1:return function(o){return e.call(t,o)};case 3:return function(o,n,r){return e.call(t,o,n,r)};case 4:return function(o,n,r,s){return e.call(t,o,n,r,s)}}return function(){return e.apply(t,arguments)}},e.exports=t},function(e,t){var o=Object.prototype.hasOwnProperty;t=function(e,t){return o.call(e,t)},e.exports=t},function(e,t,o){var n=o(22),r=o(7),s=Math.pow(2,53)-1;t=function(e){if(!e)return!1;var t=e.length;return n(t)&&t>=0&&t<=s&&!r(e)},e.exports=t},function(e,t,o){var n=o(6),r=o(10);t=function(e,t){return function(o){return r(arguments,(function(s,a){if(0!==a){var i=e(s);r(i,(function(e){t&&!n(o[e])||(o[e]=s[e])}))}})),o}},e.exports=t},function(e,t,o){var n=o(7),r=o(13),s=o(3),a=o(14),i=o(20),c=o(19),l=o(24);t=function(e,t,o){return null==e?c:n(e)?a(e,t,o):r(e)&&!s(e)?i(e):l(e)},e.exports=t},function(e,t){t=function(e){return e},e.exports=t},function(e,t,o){var n=o(21),r=o(23);t=function(e){return e=n({},e),function(t){return r(t,e)}},e.exports=t},function(e,t,o){var n=o(0);t=o(17)(n),e.exports=t},function(e,t,o){var n=o(1);t=function(e){return"[object Number]"===n(e)},e.exports=t},function(e,t,o){var n=o(0);t=function(e,t){var o=n(t),r=o.length;if(null==e)return!r;e=Object(e);for(var s=0;s<r;s++){var a=o[s];if(t[a]!==e[a]||!(a in e))return!1}return!0},e.exports=t},function(e,t,o){var n=o(3),r=o(25);t=function(e){return n(e)?function(t){return r(t,e)}:(t=e,function(e){return null==e?void 0:e[t]});var t},e.exports=t},function(e,t,o){var n=o(6),r=o(26);t=function(e,t){var o;for(o=(t=r(t,e)).shift();!n(o);){if(null==(e=e[o]))return;o=t.shift()}return e},e.exports=t},function(e,t,o){var n=o(15),r=o(3);t=function(e,t){if(r(e))return e;if(t&&n(t,e))return[e];var o=[];return e.replace(s,(function(e,t,n,r){o.push(n?r.replace(a,"$1"):t||e)})),o};var s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g;e.exports=t},,function(e,t,o){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function s(){}function a(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function i(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(r=!1)),i.prototype.eventNames=function(){var e,t,o=[];if(0===this._eventsCount)return o;for(t in e=this._events)n.call(e,t)&&o.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},i.prototype.listeners=function(e,t){var o=r?r+e:e,n=this._events[o];if(t)return!!n;if(!n)return[];if(n.fn)return[n.fn];for(var s=0,a=n.length,i=new Array(a);s<a;s++)i[s]=n[s].fn;return i},i.prototype.emit=function(e,t,o,n,s,a){var i=r?r+e:e;if(!this._events[i])return!1;var c,l,u=this._events[i],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,n),!0;case 5:return u.fn.call(u.context,t,o,n,s),!0;case 6:return u.fn.call(u.context,t,o,n,s,a),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var g,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,o);break;case 4:u[l].fn.call(u[l].context,t,o,n);break;default:if(!c)for(g=1,c=new Array(d-1);g<d;g++)c[g-1]=arguments[g];u[l].fn.apply(u[l].context,c)}}return!0},i.prototype.on=function(e,t,o){var n=new a(t,o||this),s=r?r+e:e;return this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],n]:this._events[s].push(n):(this._events[s]=n,this._eventsCount++),this},i.prototype.once=function(e,t,o){var n=new a(t,o||this,!0),s=r?r+e:e;return this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],n]:this._events[s].push(n):(this._events[s]=n,this._eventsCount++),this},i.prototype.removeListener=function(e,t,o,n){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return 0==--this._eventsCount?this._events=new s:delete this._events[a],this;var i=this._events[a];if(i.fn)i.fn!==t||n&&!i.once||o&&i.context!==o||(0==--this._eventsCount?this._events=new s:delete this._events[a]);else{for(var c=0,l=[],u=i.length;c<u;c++)(i[c].fn!==t||n&&!i[c].once||o&&i[c].context!==o)&&l.push(i[c]);l.length?this._events[a]=1===l.length?l[0]:l:0==--this._eventsCount?this._events=new s:delete this._events[a]}return this},i.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new s:delete this._events[t])):(this._events=new s,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.prefixed=r,i.EventEmitter=i,e.exports=i},,,,,,,,,,,function(e,t,o){"use strict";const n=o(5);e.exports={sync:(e,t,o)=>{const r={api:e,args:t,options:o},s=new n.XMLHttpRequest;return s.open("POST","/apihelper/assdk?t="+Date.now(),!1),s.send(JSON.stringify(r)),200===s.status?JSON.parse(s.responseText):{errMsg:e+":fail"}}}},,,,,,,function(e,t,o){"use strict";const n=o(9),r=()=>{var e;return"touristappid"===n.DevtoolsConfig.appid||(null===(e=n.DevtoolsConfig.userInfo)||void 0===e?void 0:e.isTourist)},s={login:(e,t,o)=>{o({errMsg:"login:ok",code:"the code is a mock one"})},authorize:(e,t,o)=>{o({errMsg:"authorize:fail"})},operateWXData:(e,t,o)=>{if("webapi_getuserinfo"!==t.data.api_name)o({errMsg:"operateWXData:fail"});else{const e=function(){const e=n.DevtoolsConfig.userInfo||{};return delete n.DevtoolsConfig.userInfo,"touristappid"===n.DevtoolsConfig.appid||e.isTourist?e:{}}();o({errMsg:"operateWXData:ok",data:{data:JSON.stringify({nickName:e.nickName,avatarUrl:e.headUrl,gender:"male"===e.sex?1:2,province:e.province,city:e.city,country:e.country})}})}},openSetting:(e,t,o)=>{o({errMsg:"openSetting:ok",authSetting:[{scope:"scope.userInfo",state:1}]})}};e.exports={isTourist:r,fake:s,check:function(...e){const t=e[0];return!(!r()||!s.hasOwnProperty(t))&&(console.group(new Date+" 游客模式"),console.warn(`请注意游客模式下，调用 wx.${t} 是受限的, API 的返回是工具的模拟返回`),console.groupEnd(),setTimeout(()=>{s[t].apply(null,e)}),!0)}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=new Set(["USERCODE_REQUIRED","PAGEFRAME_GENERATE_FUNC_READY"]),r=[];let s;class a{constructor(e){this.records=[],this.countdownRecords=new Set,this._commonRecordReported=!1,this._pendingReport=[],this.onMutation=e=>{if(this.countdownRecords.size>0)for(const t of e)if(t.addedNodes)for(const e of t.addedNodes)if(e instanceof HTMLScriptElement&&e.hasAttribute("countdownid")){const t=e.getAttribute("countdownid");let o;for(const e of this.countdownRecords)if(e.countdownid===t&&(e.received++,e.received>=e.expect)){this.addPoint(e.name,Date.now()),o=e;break}o&&this.countdownRecords.delete(o)}},this.report=()=>{clearTimeout(this._reportTimer),this._blocked?this._reportTimer=setTimeout(this.report,5e3):this._pendingReport.length&&(this._commonRecordReported||(this._pendingReport.unshift(...r),this._commonRecordReported=!0),s.send({command:"TIMING_REPORT",data:this._pendingReport,common:this._commonMsg}),this._pendingReport=[],this._reportTimer=setTimeout(this.report,5e3))},this.observer=new e.MutationObserver(this.onMutation),this.observer.observe(e.document.head,{childList:!0}),this._blocked=e.blocked,this.init()}static setMessager(e){s=e}init(){setTimeout(this.report,5e3)}setBlocked(e){this._blocked=e,e||this.report()}addCost(e,t,o,n){const r={type:"cost",name:e,start:t,end:o,cost:o-t,opt:n};this.records.push(r),this._pendingReport.push(r)}addPoint(e,t=Date.now()){const o={type:"point",name:e,value:t};this.records.push(o),this._pendingReport.push(o),n.has(e)&&this.report()}static addCommonPoint(e,t=Date.now()){r.push({type:"point",name:e,value:t})}prepareScriptCountdownReport(e,t,o){this.countdownRecords.add({name:e,countdownid:t,expect:o,received:0})}setCommonMessage(e){this._commonMsg=e}}t.Timing=a,window.__global.Timing=a},,,,,,,,,function(e,t,o){"use strict";const n=o(95),r=o(97),s=o(98),a=o(99),i=o(57),c=o(58),l=o(100),u=o(101),d=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),r),s),a),i),c),l),u);e.exports=d},function(e,t,o){"use strict";const n=o(4),r=o(8);let s,a,i=!1,c=!1;function l(){i||(i=!0,n.registerCallback(e=>{const{command:t,data:o}=e;"APPSERVICE_STORAGE_UPDATED"===t?(o.storage&&(s=o.storage),o.config&&(a=o.config)):"APPSERVICE_EXEC_STORAGE_SDK"===t?h[o.api]&&h[o.api](o.api,o.args,()=>{}):"APPSERVICE_RESET_STORAGE"===t&&(s=void 0,a=void 0,c=!1,l())})),c||(n.send({command:"APPSERVICE_SDK_STORAGE_ACTION",data:{action:"INIT"}}),c=!0)}function u(){if(s)return s;l()}function d(e,t,o){n.send({command:"APPSERVICE_SDK_STORAGE_ACTION",data:{action:"UPDATE",api:e,args:t,callbackID:void 0},common:o})}function g(e,t,o){const n=u();if(!n)return{action:"PROCEED"};const r=t.key;let s=t.storageId,a={};void 0===s?s=0:0!==s&&1!==s&&2!==s&&o({errMsg:e+":fail nonexistent storage space"}),a=n[s]||{};const i=a[r];o(void 0!==i?{errMsg:e+":ok",data:JSON.parse(JSON.stringify(i.data)),dataType:i.dataType}:{errMsg:e+":fail data not found"})}function f(e,t,o,n){const r=u();if(!r)return{action:"PROCEED"};const s=t.key;0===s.length&&o({errMsg:e+":fail key is empty"});let i=t.storageId,c={};void 0===i?i=0:0!==i&&1!==i&&2!==i&&o({errMsg:e+":fail nonexistent storage space"}),c=r[i]||{},r[i]=c;const l=t.data,g=t.dataType;c[s]={data:l,dataType:g};const f=0===i?a.userMaxSize:a.openDataMaxSize;JSON.stringify(r).length>1024*f*1024?o({errMsg:`${e}:fail exceed storage max size ${f}Mb`}):(d(e,t,n),o({errMsg:e+":ok"}))}function p(e,t,o,n){let r=(t||{}).storageId;const s=u();if(!s)return{action:"PROCEED"};void 0===r?r=0:0!==r&&1!==r&&2!==r&&o({errMsg:e+":fail nonexistent storage space"}),s[r]={},d(e,t,n),o({errMsg:e+":ok"})}function m(e,t,o,n){const r=u();if(!r)return{action:"PROCEED"};const s=t.key;let a=t.storageId,i={};void 0===a?a=0:0!==a&&1!==a&&2!==a&&o({errMsg:e+":fail nonexistent storage space"}),i=r[a]||{},r[a]=i,delete i[s],d(e,t,n),o({errMsg:e+":ok"})}function _(e,t,o){let n=(t||{}).storageId;const r=u();if(!r)return{action:"PROCEED"};let s={};void 0===n?n=0:0!==n&&1!==n&&2!==n&&o({errMsg:e+":fail nonexistent storage space"}),s=r[n]||{},r[n]=s;const i={keys:Object.keys(s),currentSize:Math.ceil(JSON.stringify(s).length/1024)};i.limitSize=1024*a.userMaxSize,i.errMsg=e+":ok",o(i)}r.on("RESET_INSTANCE",()=>{s=void 0,c=!1,l()});const h={getStorage:g,clearStorage:p,setStorage:f,removeStorage:m,getStorageInfo:_,getStorageSync:g,setStorageSync:f,clearStorageSync:p,removeStorageSync:m,getStorageInfoSync:_};-1!==navigator.userAgent.indexOf("game")&&l(),e.exports=h},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(4),r=o(8);let s,a={},i=!1,c={};function l(e){const t=e||"all";c[t]||(n.send({command:"APPSERVICE_SDK_DEVICE_ACTION",data:{action:"INIT",args:{type:e}}}),c[t]=!0)}function u(e,t,o){const r=function(e={}){const{type:t}=e;return!t&&s?JSON.parse(JSON.stringify(s)):t&&a[t]?JSON.parse(JSON.stringify(a[t])):(i||(i=!0,n.registerCallback(e=>{const{command:o,data:n}=e;"APPSERVICE_DEVICE_UPDATED"===o&&(n.type?a[t]=n.systemInfo:s=n.systemInfo)})),void l(t))}(t);if(!r)return{action:"PROCEED"};o(r)}r.on("RESET_INSTANCE",()=>{s=void 0,a={},c={},l()}),r.on("SET_SYSTEM_INFO",e=>{s=e,c.all=!0}),t.getSystemInfoSync=u,t.getSystemInfo=function(e,t,o){return u(0,t,o)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(87);const n=o(47),r=o(9),s=o(90),a=o(93),i=o(107),c=o(108),l=o(109),u=o(111),d=o(112),g=o(5),f=o(113),p=o(114),m=o(4),_=o(12);n.Timing.setMessager(m),location.pathname.endsWith("mainframe")||(window.__global.timing=new n.Timing({document:document,MutationObserver:window.MutationObserver||window.__global.MutationObserver})),p(window);-1!==g.navigator.userAgent.indexOf("game")?f.init():d(),window.__global.getNewWeixinJSBridge=(e,t)=>{const o={},n=()=>{const{invoke:e}=a(o),{publish:t}=c(o),{publishSync:n}=l(o),{subscribe:r,triggerSubscribeEvent:d}=u(),{on:g,triggerOnEvent:f}=s(),{beforeinvoke:p,afterinvoke:m}=i(o);return{invoke:e,publish:t,subscribe:r,on:g,publishSync:n,beforeinvoke:p,afterinvoke:m,get __triggerOnEvent(){return f},get __triggerSubscribeEvent(){return d},__unblock:()=>{},__setCommonPayload(e,t){o[e]=t}}};if(t){let e,t=[];const r=(o,...n)=>{e?e[o].apply(e,n):t.push({method:o,args:n})};let s=!1;return{invoke:r.bind(null,"invoke"),publish:r.bind(null,"publish"),subscribe:r.bind(null,"subscribe"),on:r.bind(null,"on"),publishSync:r.bind(null,"publishSync"),beforeinvoke:r.bind(null,"beforeinvoke"),afterinvoke:r.bind(null,"afterinvoke"),__triggerOnEvent:r.bind(null,"__triggerOnEvent"),__triggerSubscribeEvent:r.bind(null,"__triggerSubscribeEvent"),__unblock:()=>{if(!s){s=!0,e=n();for(const{method:o,args:n}of t)try{e[o].apply(null,n)}catch(e){console.error(e)}t=[]}},__setCommonPayload(e,t){o[e]=t}}}return n()},window.WeixinJSBridge=window.__global.WeixinJSBridge=window.__global.getNewWeixinJSBridge("global"),window.__global.WeixinJSBridgeMap={__globalBridge:window.WeixinJSBridge},window.NativeGlobal={createBufferURL:e=>{var t;let o={};if(window.__global.WeixinJSBridge.invoke("createBufferURL",{buffer:e},e=>{o=e}),null===(t=null==o?void 0:o.errMsg)||void 0===t?void 0:t.startsWith("createBufferURL:fail")){throw new Error(o.errMsg)}return o.url},revokeBufferURL:e=>{var t;let o={};if(window.__global.WeixinJSBridge.invoke("revokeBufferURL",{url:e},e=>{o=e}),null===(t=null==o?void 0:o.errMsg)||void 0===t?void 0:t.startsWith("revokeBufferURL:fail")){throw new Error(o.errMsg)}return o.result}};r.DevtoolsConfig.online&&r.DevtoolsConfig.autoTest&&setInterval(()=>{console.clear()},6e5),_.calibration(),n.Timing.addCommonPoint("ASDEBUG_LOADED")},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(28),r=o(4),s=o(88),a=o(89),i=o(8),c=o(12);class l{constructor(){this.globalSessionId=Date.now(),this.idCounter=1,this.frames=new Map,this.currentFrameId=0,this.runtimeInstanceInfo={},this.verbose=!1,this.messagerCallback=e=>{const{command:t,data:o}=e;"LOAD_APPSERVICE"===t?(r.setAppserviceReady(!1),i.emit("RESET_INSTANCE"),this.runtimeInstanceInfo.compileTs=o.compileTs,o.initOptions&&o.initOptions.systemInfo&&i.emit("SET_SYSTEM_INFO",o.initOptions.systemInfo),o.error||this.loadAppService(o.scripts,o.hardReload)):"RESET"===t?this.reset({clearPreload:o.clearPreload,shouldPreload:o.shouldPreload}):"PRELOAD"===t&&this.preload()},r.registerCallback(this.messagerCallback);try{this.runtimeInstanceInfo={compileTs:Number(location.search.match(/cts=(\d+)/)[1])}}catch(e){const t=__global.prompt("GET_RUNTIME_INSTANCE_INFO");this.runtimeInstanceInfo=JSON.parse(t)}this.loadAppService(),s.proxyGlobalVarToInstanceFrame(this)}isLoadSuccess(e){const t=e.iframe;let o=!0;try{t.contentWindow.location&&(o=!0)}catch(e){o=!1}return o}isValidFrame(e){return this.frames.has(e)}isValidCurrentFrame(e){return this.frames.has(e)&&this.currentFrameId===e}loadAppService(e,t){if(0===this.frames.size||t){if(t){this.verbose&&this.groupDebug("info","--loader--","will force load");for(const[e,t]of this.frames)this.disposeFrame(t)}const e=this.idCounter++;this.currentFrameId=e;const o=this.initASFrameInfo({id:e,iframe:void 0,status:"void",statusChangeEE:new n.EventEmitter,statusUpdateTs:Date.now(),statusChangeListeners:{},instanceInfo:Object.assign({},this.runtimeInstanceInfo),timing:{loadStartTs:Date.now()}});this.frames.set(e,o),this.verbose&&this.groupDebug("info","--loader--","will create new frame",e),a.createIframeElement(this.generateInstanceFrameSrc(e,!0)).then(e=>{o.iframe=e,o.status="loading"})}else{let o=!1;const n=new Set,r=[...this.frames.values()];for(const t of r)if(o)n.add(t);else switch(t.status){case"void":o=!0,this.currentFrameId=t.id;break;case"preloading":{o=!0,this.verbose&&this.groupDebug("info","--loader--","got a preloading",t.id),this.currentFrameId=t.id,t.instanceInfo=Object.assign({},this.runtimeInstanceInfo),t.statusChangeListeners.waitPreloading&&(clearTimeout(t.statusChangeListeners.waitPreloading.timeoutId),t.statusChangeEE.off("change",t.statusChangeListeners.waitPreloading.listener),this.verbose&&this.groupDebug("warn","clear previous wait before trying to load preloading frame "+t.id));const n=setTimeout(()=>{this.groupLog("warn","preloading -> timedout"),t.status="timedout"},5e3);this.verbose&&this.groupDebug("warn","[--loader--] try to load preloading frame "+t.id);const r=()=>{this.verbose&&this.groupDebug("info","--loader--","listener triggered",t.id),"preloaded"===t.status&&(this.verbose&&this.groupDebug("info","--loader--","preloaded triggered",t.id),clearTimeout(n),t.statusChangeEE.off("change",r),t.status="loading",t.iframe.contentWindow.__global.timing.addPoint("APPRESOURCE_LOAD_START",Date.now()),a.loadScripts(t.iframe.contentDocument,e))};t.statusChangeEE.on("change",r),t.statusChangeListeners.waitPreloading={timeoutId:n,listener:r};break}case"preloaded":o=!0,this.verbose&&this.groupDebug("info","--loader--","got a preloaded",t.id),this.currentFrameId=t.id,t.instanceInfo=Object.assign({},this.runtimeInstanceInfo),t.status="loading",t.iframe.contentWindow.__global.timing.addPoint("APPRESOURCE_LOAD_START",Date.now()),a.loadScripts(t.iframe.contentDocument,e);break;case"loading":case"loaded":case"errored":case"timedout":n.add(t);break;default:this.groupLog("warn",`[loader] unknown status ${t.status}. (getFirstAvailableFrame)`),n.add(t)}if(n.forEach(e=>{this.disposeFrame(e)}),!o){this.verbose&&this.groupDebug("info","--loader--","found = false");[...this.frames.values()].forEach(e=>this.disposeFrame(e)),this.loadAppService(e,t)}}}preload(){this.verbose&&this.groupDebug("info","--loader-- preload()");for(const e of this.frames.values())if("preloading"===e.status||"preloaded"===e.status)return void(this.verbose&&this.groupDebug("info","--loader-- already a preload element"));const e=this.idCounter++,t=this.initASFrameInfo({id:e,iframe:void 0,status:"void",statusChangeEE:new n.EventEmitter,statusUpdateTs:Date.now(),statusChangeListeners:{},timing:{preloadStartTs:Date.now()}});this.frames.set(e,t),this.verbose&&this.groupDebug("info","--loader-- will preload",e,t),a.createIframeElement(this.generateInstanceFrameSrc(e)).then(e=>{t.iframe=e,t.status="preloading"})}loadSrc(e,t){try{const o=e.iframe.contentWindow;o.__global.history.pushState("","",t),o.location.reload()}catch(t){this.verbose&&this.groupDebug("warn","loadSrc catch error",t),e.status="errored",this.disposeFrame(e),1===this.frames.size&&this.preload()}}handleLoadStart(e){var t;const o=e.location.search.includes("autoload"),n=Number(e.location.hash.match(/#id_(\d+)/)[1]);this.verbose&&this.groupDebug("info","--loader-- handleLoadStart",null===(t=e.location)||void 0===t?void 0:t.href);const r=this.frames.get(n);r&&(s.createInstanceFrameInitialGlobal({id:n,win:e,isPreload:!o,asLoader:this}),e.__global.asSubLoader.initWithContexts(),e.addEventListener("load",()=>{var t;if(this.verbose&&this.groupDebug("info","--loader-- win onload",null===(t=e.location)||void 0===t?void 0:t.href),this.isValidFrame(n))if(o){const t=this.getFrameContextDelegate(r);(null==t?void 0:t.onceActiveAppserviceContextFrameLoadedScripts)?t.onceActiveAppserviceContextFrameLoadedScripts(()=>{var t;this.verbose&&this.groupDebug("info","--loader-- triggered onceActiveAppserviceContextFrameLoadedScripts",null===(t=e.location)||void 0===t?void 0:t.href),this.handleLoadDone(e,n)}):this.handleLoadDone(e,n)}else this.isLoadSuccess(r)?(this.verbose&&this.groupDebug("info","--loader-- will set preloaded",{win:e,href:e.location.href}),r.status="preloaded",r.timing.preloadEndTs=Date.now(),r.timing.preloadCost=r.timing.preloadEndTs-r.timing.preloadStartTs):r.status="errored"}),c.calibration())}handleLoadDone(e,t){var o;if(this.verbose&&this.groupDebug("info","--loader-- handleLoadDone",null===(o=e.location)||void 0===o?void 0:o.href),!this.isValidCurrentFrame(t))return;const n=this.frames.get(t);if(!this.isLoadSuccess(n))return void(n.status="errored");if("loaded"===n.status)return;if(!n.instanceInfo)return void this.groupLog("error","frame loaded without instanceInfo");e.performance.mark("documentReadyAlertStart"),e.__global.alert("DOCUMENT_READY"),e.performance.mark("documentReadyAlertEnd");const s=new e.__global.CustomEvent("LOADER_LOAD_DONE");e.dispatchEvent(s),e.__global.WeixinJSBridge.__setCommonPayload("compileTs",n.instanceInfo.compileTs),e.__global.WeixinJSBridge.__unblock(),r.setAppserviceReady(!0,e.JSON.parse.bind(e.JSON)),e.__global.timing.setCommonMessage(n.instanceInfo),e.__global.timing.setBlocked(!1),n.status="loaded",n.timing.loadEndTs=Date.now(),e.__global.requestIdleCallback(()=>{e.__global.timing.report()});const a="@appservice-current-context";this.getFrameContextDelegate(n)?this.getActiveAppserviceContextFrameWindow(n).then(t=>{t.__global.__consoleDebug?t.__global.__consoleDebug(`${a}#${n.id}`):e.console.debug(a)}):e.console.debug(a)}handleWxConfigReady(e,t){const o=Number(e.location.hash.match(/#id_(\d+)/)[1]),n=this.frames.get(o);if(!n)return;if(!n.instanceInfo)return void this.groupLog("error","during handleWxConfigReady, frame instanceInfo not found");const r=t||e;r.__global.WeixinJSBridge.__setCommonPayload("compileTs",n.instanceInfo.compileTs),r.__global.WeixinJSBridge.__unblock()}getFrameContextDelegate(e){var t,o;const n=null===(o=null===(t=null==e?void 0:e.iframe.contentWindow)||void 0===t?void 0:t.__global)||void 0===o?void 0:o.__contextSupport;return null==n?void 0:n.delegate}getActiveAppserviceContextFrameWindowSync(e){var t,o;const n=this.getFrameContextDelegate(e),r=null===(t=null==n?void 0:n.getActiveAppserviceContextFrameSync)||void 0===t?void 0:t.call(n);return null!==(o=null==r?void 0:r.iframe.contentWindow)&&void 0!==o?o:window}async getActiveAppserviceContextFrameWindow(e){var t,o;const n=this.getFrameContextDelegate(e);if(!n)return Promise.resolve(window);const r=await(null===(t=null==n?void 0:n.getActiveAppserviceContextFrame)||void 0===t?void 0:t.call(n));return null!==(o=null==r?void 0:r.iframe.contentWindow)&&void 0!==o?o:window}disposeFrame(e){var t,o,n;if(this.verbose&&this.groupDebug("warn","dispose frame",e,null==e?void 0:e.id),e=e||this.frames.get(this.currentFrameId)){if(null===(o=null===(t=this.getFrameContextDelegate(e))||void 0===t?void 0:t.disposeAll)||void 0===o||o.call(t),this.frames.delete(e.id),this.currentFrameId===e.id)if(this.frames.size>0)for(const[e,t]of this.frames){this.currentFrameId=t.id;break}else this.currentFrameId=-1;null===(n=__global.cfn)||void 0===n||n.call(__global,e),r.send({command:"DELETE_IFRAME",data:{src:e.iframe.src}}),setTimeout(()=>{(null==e?void 0:e.iframe.parentElement)&&e.iframe.parentElement.removeChild(e.iframe)},1e3),this.clearStatusChangeListeners(e)}}clearStatusChangeListeners(e){for(const t in e.statusChangeListeners){const o=e.statusChangeListeners[t];clearTimeout(o.timeoutId),e.statusChangeEE.off("change",o.listener),this.verbose&&this.groupDebug("warn",`clear ${t} listener of frame ${e.id}`)}e.statusChangeListeners={}}reset(e={}){const{clearPreload:t,shouldPreload:o=!0}=e;if(this.verbose&&this.groupDebug("warn",`reset triggered. clearPreload ${t}, shouldPreload ${o}`),r.setAppserviceReady(!1),i.emit("RESET_INSTANCE"),-1!==this.currentFrameId){const e=this.frames.get(this.currentFrameId);!t&&"preloaded"===(null==e?void 0:e.status)||"preloading"===(null==e?void 0:e.status)||this.disposeFrame()}if(t){const e=[...this.frames.values()];for(const t of e)this.disposeFrame(t);o&&this.preload()}else{const e=new Set;let t;for(const[o,n]of this.frames){if(!t){switch(n.status){case"preloaded":case"preloading":t=n,this.clearStatusChangeListeners(n);break;default:e.add(n)}break}e.add(n)}for(const t of e)this.disposeFrame(t);!t&&o&&this.preload()}}async getCurrentInstanceFrame(){const e=this.frames.get(this.currentFrameId);if(!e){const e="no current frame during getCurrentInstanceFrame";throw this.groupLog("error",e),new Error("[loader] "+e)}switch(e.status){case"preloaded":case"loaded":return e.iframe;case"loading":case"preloading":return new Promise((t,o)=>{const n=setTimeout(()=>{e.status="timedout"},5e3),r=()=>{"preloaded"===e.status||"loaded"===e.status?(clearTimeout(n),e.statusChangeEE.off("change",r),t(e.iframe)):"errored"===e.status&&o("[loader] frame load errored")};e.statusChangeEE.on("change",r),e.statusChangeListeners.waitGetFrame={timeoutId:n,listener:r}});case"blank":case"errored":default:throw new Error("[loader] unexpected current frame status "+e.status)}}generateInstanceFrameSrc(e,t){let o=`${location.protocol}//${location.host}/appservice/instanceframe?s=${this.globalSessionId}`;return t&&(o+="&autoload"),o+="#id_"+e,o}initASFrameInfo(e){const t=this;let o=e.status;return Object.defineProperty(e,"status",{get:()=>o,set(n){o!==n&&(t.verbose&&t.groupDebug("warn",`id ${e.id} change status from ${o} to ${n}`,(new Error).stack),o=n,e.statusUpdateTs=Date.now(),e.statusChangeEE.emit("change",e))}}),e}proxyAlert(e,t){if(!this.isValidCurrentFrame(e))return void(this.verbose&&this.groupDebug("warn",`reject non-current frame (id ${e}) alert req with msg: ${t}`));const o=this.frames.get(e);return t.startsWith("SUBPACKAGE_READY_")&&("loaded"!==o.status&&setTimeout(()=>{var t;if(e===this.currentFrameId){const n=(null===(t=o.iframe.contentWindow.__global.asSubLoader)||void 0===t?void 0:t.activeAppWindow)||o.iframe.contentWindow;this.handleLoadDone(n,e)}}),o.iframe.contentWindow.__global.asSubLoader.emit(t)),__global.alert("$$"+JSON.stringify({msg:t,common:o.instanceInfo}))}proxyPrompt(e,t){if(!this.isValidCurrentFrame(e))return void(this.verbose&&this.groupDebug("warn",`reject non-current frame (id ${e}) prompt req with msg: ${t}`));const o=this.frames.get(e);return __global.prompt("$$"+JSON.stringify({msg:t,common:o.instanceInfo}))}getInstanceWindowSync(){const e=this.frames.get(this.currentFrameId);try{return null==e?void 0:e.iframe.contentWindow}catch(e){return}}groupLog(e,...t){console.group(new Date+" 开发者工具 AppService 内部错误"),console[e]("[--loader--]",...t),console.groupEnd()}groupDebug(e,...t){if(this.verbose){try{console[e]("[--loader--]",...t)}catch(e){console.warn("[--loader--] error while outputing debug log",e)}console.groupEnd()}}}if(t.ASLoader=l,location.pathname.endsWith("mainframe")){const e=new l;window.__global.asLoader=e,window.__global.getInstanceWindow=async()=>(await e.getCurrentInstanceFrame()).contentWindow,window.__global.getActiveAppWindow=async()=>{var t;const o=(await e.getCurrentInstanceFrame()).contentWindow;return((null===(t=o.__global)||void 0===t?void 0:t.asSubLoader)?o.__global.asSubLoader.activeAppWindow:o)||o}}else r.setAppserviceReady(!0),window.__global.getInstanceWindow=async()=>window,window.__global.getActiveAppWindow=async()=>{var e;const t=window;return((null===(e=t.__global)||void 0===e?void 0:e.asSubLoader)?t.__global.asSubLoader.activeAppWindow:t)||t}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInstanceFrameInitialGlobal=e=>{const{id:t,win:o,isPreload:n,asLoader:r}=e,s=o.__passWAServiceGlobal__||function(){};if(o.__global.WAServiceGlobal={},o.__passWAServiceGlobal__=function(e){for(const t in e)"Protect"!==t&&(o.__global.WAServiceGlobal[t]=e[t]);s(e)},o.__wxAppData={},o.__wxRoute=void 0,o.__wxRouteBegin=void 0,o.__wxAppCode__={},o.__wxAppCurrentFile__=void 0,o.__vd_version_info__={},o.Component=function(){},o.Behavior=function(){},o.definePlugin=function(){},o.requirePlugin=function(){},o.global={},o.__workerVendorCode__={},o.__workersCode__={},o.__global.WeixinWorker=o.WeixinWorker={},o.$gwx=void 0,o.__global.id=t,o.WeixinJSBridge=o.__global.WeixinJSBridge=__global.getNewWeixinJSBridge("global",n),__global.__getNewWeixinJSContext){const e=Object.assign({},__global.__contextSupport||{});o.__global.__contextSupport=e,o.WeixinJSContext=o.__global.WeixinJSContext=__global.__getNewWeixinJSContext({obj:new o.Object,window:o,ObjectPrototype:o.Object.prototype,scopedContextSupport:e,bridge:o.WeixinJSBridge,locationHash:o.location.hash,parentId:"ifr-"+t})}o.__global.timing=new __global.Timing({document:o.document,MutationObserver:o.__global.MutationObserver,blocked:!0}),o.__global.asLoader=r,o.alert=o.__global.alert=r.proxyAlert.bind(r,t),o.prompt=o.__global.prompt=r.proxyPrompt.bind(r,t),o.NativeGlobal={createBufferURL:e=>{let t={};if(o.__global.WeixinJSBridge.invoke("createBufferURL",{buffer:e},e=>{t=e}),null==t?void 0:t.errMsg.startsWith("createBufferURL:fail")){throw new Error(t.errMsg)}return t.url},revokeBufferURL:e=>{let t={};if(o.__global.WeixinJSBridge.invoke("revokeBufferURL",{url:e},e=>{t=e}),null==t?void 0:t.errMsg.startsWith("revokeBufferURL:fail")){throw new Error(t.errMsg)}return t.result}}},t.proxyGlobalVarToInstanceFrame=function(e){const t=()=>{var t;const o=e.frames.get(e.currentFrameId);if(o)return(null===(t=null===__global||void 0===__global?void 0:__global.__contextSupport)||void 0===t?void 0:t.isIsolateContext)&&e.getActiveAppserviceContextFrameWindowSync(o)||o.iframe.contentWindow},o=e=>e;[{name:"__wxAppData",defaultValue:{}},{name:"__wxAppCode__",defaultValue:{}},{name:"WAServiceGlobal",defaultValue:{},subpathGetter:e=>e.__global},{name:"__wxAppCurrentFile__",defaultValue:void 0,proxySet:!0},{name:"__workersCode__",defaultValue:{}},{name:"__workerVendorCode__",defaultValue:{}},{name:"WeixinWorker",defaultValue:{}},{name:"__WeixinWorker",defaultValue:{}},{name:"__vd_version_info__",defaultValue:{}},{name:"__passWAServiceGlobal__",defaultValue:void 0,proxySet:!0},{name:"__devtoolsUseBeforeInvoke__",defaultValue:!1},{name:"wx",defaultValue:{}},{name:"getApp",defaultValue:void 0},{name:"getCurrentPages",defaultValue:void 0},{name:"global",defaultValue:{}},{name:"__wxConfig",defaultValue:{}},{name:"__devtoolsConfig",defaultValue:{}},{name:"WeixinJSBridge",defaultValue:void 0},{name:"__interfaceBuilder",defaultValue:!1}].forEach(e=>{Object.defineProperty(e.subpathGetter?e.subpathGetter(window):window,e.name,{get:()=>((e=o,n,r)=>{var s;try{const o=t();return o&&(null!==(s=e(o)[n])&&void 0!==s)?s:r}catch(e){return r}})(e.subpathGetter,e.name,e.defaultValue),set:n=>(e.proxySet&&((e=o,n,r)=>{const s=t();s&&(e(s)[n]=r)})(e.subpathGetter,e.name,n),!0),enumerable:!0})})}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createIframeElement=async function(e="about:blank"){const t=document.createElement("iframe");return t.style.borderWidth="0px",t.style.width="100%",t.style.height="100%",t.src=e,document.body?(document.body.appendChild(t),t):new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(t),e(t)})})},t.ignoreKeys=new Set(["dedupId"]),t.loadScripts=async function(e,o){if(o)for(const n of o){const o=e.createElement("script");o.charset="UTF-8";let r=!0;for(const e in n)if("async"===e)r=!1;else{if(t.ignoreKeys.has(e))continue;o[e]=n[e]}r&&o.src?await new Promise(t=>{o.addEventListener("load",t),o.addEventListener("error",t),e.head.appendChild(o)}):e.head.appendChild(o)}}},function(e,t,o){"use strict";const n=o(91),r=o(12),s=o(4),a=o(8);e.exports=function(){const e=a.instanceScope();let t={},o=!1,i=!1;function c(e,r,s){if(o)return void console.warn("[memory-leak] triggerOnEvent called on a deprecated instance");t.triggerWorkerEvent&&"function"==typeof t.triggerWorkerEvent&&t.triggerWorkerEvent(e,n(r));const a=t[e];if("function"==typeof a)try{a(r,s)}catch(e){console.error(e)}}const l=e=>{const{command:t,data:o,webviewID:n}=e;"APPSERVICE_ON_EVENT"===t&&(r.coverRes(o.data),c(o.eventName,o.data,n))};return i||(i=!0,s.registerCallback(l)),e.on("triggerOnEvent",(function(e,t,o){c(e,t,o)})),window.DeviceOrientation=function(e,t,n){o||c("onAccelerometerChange",{x:e,y:t,z:n})},a.once("RESET_INSTANCE",()=>{o=!0,t={},s.removeCallback(l)}),{on:function(e,n){o||(r.debugLog(`${new Date} WeixinJSBridge on ${e}`,arguments),r.debugInfo({type:"on",eventName:e,data:arguments,timesmap:new Date}),n&&(t[e]=n))},triggerOnEvent:c}}},function(e,t,o){var n=o(13),r=o(7),s=o(3),a=o(92);t=function(e){return s(e)?e.map((function(e){return t(e)})):n(e)&&!r(e)?a(e,(function(e){return t(e)})):e},e.exports=t},function(e,t,o){var n=o(18),r=o(0);t=function(e,t,o){t=n(t,o);for(var s=r(e),a=s.length,i={},c=0;c<a;c++){var l=s[c];i[l]=t(e[l],l,e)}return i},e.exports=t},function(e,t,o){"use strict";const n=o(46),r=o(4),s=o(94),a=o(56),i=o(103),c=o(104),l=o(105),u=o(39),d=o(12),g=o(9),f=o(8),p=o(106),{arrayBufferToBase64:m,coverRes:_,evaluateRes:h,isKindOfArrayBuffer:v,coverResToOriginArgs:b}=d,{modifyComponentData:y}=p,{isSyncSDK:S,needTransArgsBase64Api:w,genIdForDevTools:E,invokeNeedToDevtoolsApi:C}=g;let k,T,{isUseApiMock:A,apiMockApiList:I}=g,D=!1,O=!1;function M(){O||(r.registerCallback(e=>{const{command:t,data:o}=e;"SIMULATOR_APPSERVICE_HOOK_METHODS_CACHE_UPDATED"===t&&o.pluginHookMethodsCache&&(k=o.pluginHookMethodsCache)}),O=!0),D||(r.send({command:"SIMULATOR_APPSERVICE_HOOK_METHODS_CACHE_ACTION",data:{action:"get"}}),D=!0)}function P(e,t){var o;if(!i[t])return!1;const n=(k||M(),k);return!!n&&!!(null===(o=n[e])||void 0===o?void 0:o[t])}let x=!1,R=!1;function L(){R||(r.registerCallback(e=>{const{command:t,data:o}=e;"APPSERVICE_HOOK_METHODS_CACHE_UPDATED"===t&&o.pluginHookMethodsCache&&(T=o.pluginHookMethodsCache)}),R=!0),x||(r.send({command:"APPSERVICE_HOOK_METHODS_CACHE_ACTION",data:{action:"get"}}),x=!0)}function N(){return T||L(),T}function U(e,t){var o;if(!C[t])return!1;const n=N();if(n){const r=C[t];return!!(null===(o=n[e])||void 0===o?void 0:o[r])}return!1}function B(e){return P("APPSERVICE_ON_BEFORE_INVOKE",e)||U("APPSERVICE_ON_BEFORE_INVOKE_API_PREVENT",e)}function W(e){return P("APPSERVICE_ON_AFTER_INVOKE",e)||U("APPSERVICE_ON_AFTER_INVOKE_API_PREVENT",e)}__global.getHookMethodsCache=N,f.on("RESET_INSTANCE",()=>{D=!1,M(),x=!1,L()}),e.exports=function(e){const t={};let o=1,i=!1,p=!1;const C=e=>{const{command:o,data:n}=e;if("APPSERVICE_INVOKE_CALLBACK"===o){if(n.res.needImplement){const{api:e,args:o}=n.res;a[e](e,o,t[n.callbackID])}else{const e=n.callbackID,o=t[e];_(n.res),"function"==typeof o&&o(n.res)}delete t[n.callbackID]}else"APPSERVICE_INVOKE_EMITTER"===o?f.emit("triggerOnEvent",n.name,n.payload):"API_MOCK_STATUS_CHANGE"===o?A=n:"API_MOCK_APILIST_CHANGE"===o&&(I=n.apiList);"MODIFY_COMPONENT_DATA"===o&&y(n.id,n.componentData,n.webviewId)},k=function(e,t,o,n){return function(r){o&&r.__toOrigin&&b(r,o),"function"==typeof t&&(e||n?t(r):setTimeout(()=>{t(r)},0))}};function T(e,t,o){const r=t=>{const n=S(e);"function"==typeof o&&(n?o(t):setTimeout(()=>{o(t)},0))};return i?(r({errMsg:e+": deprecated"}),!0):window.__interfaceBuilder&&g.ibForbiddenApi[e]?(console.log("interfacebuilder disabled invoke",e,t),r({errMsg:e+": interfacebuilder disabled"}),!0):!!n.check(e,t,r)||!(!s[e]||s[e](e,t,r))}return f.once("RESET_INSTANCE",()=>{i=!0,r.removeCallback(C)}),p||(p=!0,r.registerCallback(C)),{invoke:function(n,s,i){if(T(n,s,i))return;if(d.debugLog(`${new Date} WeixinJSBridge invoke ${n}`,arguments),d.debugInfo({type:"invoke",eventName:n,data:arguments,timesmap:new Date}),w[n])for(const e in s)v(s[e])&&(s[e]=m(s[e]));const g={};if(c[n])for(const e in s)c[n].is(s[e],e)&&(c[n].saveOrigin&&(g[e]=s[e]),s[e]=c[n].trans(s,s[e]));const f=S(n),p=k(f,i,g);if(l[n]){const e=l[n](n,s,p);if(!e)return;s=e}const b=E(n,s),y=b?Object.assign(Object.assign({},s),{__devtoolsId:b}):s;if(a[n]&&(!A||void 0===I[n])&&!B(n)&&!W(n)){const t=a[n](n,s,p,e);if("PROCEED"!==(null==t?void 0:t.action))return}const C=o++;if(!f)return t[C]=k(f,i,g,!0),void r.send({command:"APPSERVICE_INVOKE",data:{api:n,args:y,callbackID:C},common:e});const D=u.sync(n,y);D.needImplement?a[n](n,s,p):(h(D),_(D),delete D.to,p(D))}}}},function(e,t,o){"use strict";const n=o(9),r=o(12),{checkUrl:s}=r,{urlCheckErrReason:a}=n,i={downloadFile:function(e,t,o){return!!s(t.url,"downloadFile")||(o({errMsg:`${e}:fail ${a}`}),!1)},uploadFile:function(e,t,o){return!!s(t.url,"uploadFile")||(o({errMsg:`${e}:fail ${a}`}),!1)},createUploadTask:function(e,t,o){return!(!t.__skipDomainCheck__&&!s(t.url,"uploadFile"))||(o({errMsg:`${e}:fail ${a}`}),!1)},createDownloadTask:function(e,t,o){return!(!t.__skipDomainCheck__&&!s(t.url,"downloadFile"))||(o({errMsg:`${e}:fail ${a}`}),!1)},authorize:function(e,t,o){return"scope.userInfo"===t.scope&&(console.group(new Date+" 接口调整"),console.error('wx.authorize({scope: "scope.userInfo"}) 不会出现授权弹窗，请使用 <button open-type="getUserInfo />\n参考文档: https://developers.weixin.qq.com/blogdetail?action=get_post_info&lang=zh_CN&token=1650183953&docid=0000a26e1aca6012e896a517556c01'),console.groupEnd()),!0}};e.exports=i},function(e,t,o){"use strict";const n=o(96),r=o(8),s=o(9),a=o(12),i=o(5),{MaxRequestConcurrent:c,urlCheckErrReason:l}=s,{checkUrl:u}=a,d={};let g=1,f=0,p=Date.now();r.on("RESET_INSTANCE",()=>{f=0,p=Date.now()});const m=function(e){return function(t){"function"==typeof e&&e(t)}},_={"accept-charset":!0,"accept-encoding":!0,"access-control-request-headers":!0,"access-control-request-method":!0,connection:!0,"content-length":!0,cookie:!0,cookie2:!0,date:!0,dnt:!0,expect:!0,host:!0,"keep-alive":!0,origin:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,via:!0};function h(e,t){const{origin:o,tls:n}=e;console.group(new Date+" wx.request 错误"),console.error(`${o} 对应的服务器 TLS 为 ${n} ，小程序要求的 TLS 版本必须大于等于 1.2 。控制台输入 showRequestInfo() 可以获取更详细信息。`),console.groupEnd(),t({errMsg:"request:fail 小程序要求的 TLS 版本必须大于等于 1.2"})}function v(e,t){const{origin:o}=e;console.group(new Date+" wx.request 错误"),console.error(o+" 对应的服务器证书无效。控制台输入 showRequestInfo() 可以获取更详细信息。"),console.groupEnd(),t({errMsg:"request:fail 对应的服务器证书无效。"})}const b=(e,t,o,a)=>{var d;f++;const g=p,m=e=>{g===p&&setTimeout(()=>{f--,"function"==typeof o&&o(e)})},{url:b,responseType:y,__skipDomainCheck__:C,method:k="POST",header:T={}}=t;if(function(e,t,o){const{url:r,__skipDomainCheck__:s,method:a="POST"}=t;if(f>c)return console.group(new Date+" request 错误"),console.error(`同时最多发起 ${c} 个 request 请求，更多请参考文档：https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html`),console.groupEnd(),o({errMsg:e+":fail exceed max task count"}),!0;if(!s&&!u(r))return o({errMsg:`${e}:fail ${l}`}),!0;if(["OPTIONS","GET","HEAD","POST","PUT","DELETE","TRACE","CONNECT"].indexOf(a)<0)return o({errMsg:e+":fail method is invalid"}),!0;const i=n.getSecuryDetailsByURL(r);if(i.isReady){if(!i.isSecuryTLS)return h(i,o),!0;if(!i.isSecuryCertificate)return v(i,o),!0}return!1}(e,t,m))return;const A=function(){let e=i.XMLHttpRequest;if(i.asLoader){const t=i.asLoader.getInstanceWindowSync();e=t?t.__global.XMLHttpRequest:void 0}return e}();if(!A)return void m({errMsg:e+":fail runtime invalidated"});let I=0;const D=new A;D.disableHttp2=!t.enableHttp2,D.responseType=y||"text",t.enableChunked&&(D.responseType="text"),D.timeout=t.timeout||(null===(d=__wxConfig.networkTimeout)||void 0===d?void 0:d.request)||6e4,D.open(k,t.url,!0),D.onreadystatechange=()=>{if(D.readyState===(D.HEADERS_RECEIVED||2))try{let e={};try{e=JSON.parse(D.getResponseHeader("for-weapp-devtools"))}catch(e){}if("function"==typeof a&&s.libNumberVersion>=1009093){const o={state:"headersReceived",header:w(e||{}),cookies:S(e||{})};t.enableChunked&&(o.statusCode=D.status),a(o)}}catch(e){console.error(e)}if(D.readyState,4===D.readyState){D.onreadystatechange=null;const s=D.status;if(0===s);else{const a=n.getSecuryDetailsByURL(b);let i={};try{i=JSON.parse(D.getResponseHeader("for-weapp-devtools"))}catch(e){}function o(o){if(!o.isSecuryTLS)return void h(o,m);if(!o.isSecuryCertificate)return void v(o,m);if(D.responseURL&&!C&&!u(D.responseURL))return void m({errMsg:`${e}:fail ${l}`});const n={errMsg:e+":ok",header:w(i||{}),cookies:S(i||{}),statusCode:s};"arraybuffer"===D.responseType?n.data=D.response:n.data=D.responseText,t.enableChunked&&(n.data=""),m(n)}a.isReady?o(a):r.instanceScope().once("TLS_CHECK_READY_"+a.id,o)}}},D.onprogress=function(){var e,o;if(t.enableChunked&&!t.enableHttp2&&"chunked"===D.getResponseHeader("transfer-encoding")&&"function"==typeof a&&s.libNumberVersion>=1009093)try{const t=null===(e=D.responseText)||void 0===e?void 0:e.length;if(I===t)return;D.timeout=0;const n=null===(o=D.responseText)||void 0===o?void 0:o.substring(I,t);I=t,a({state:"chunked",data:E(n)})}catch(e){}},D.onerror=()=>{m({errMsg:e+":fail"})},D.ontimeout=()=>{m({errMsg:e+":fail timeout"})},D.onabort=()=>{m({errMsg:e+":fail abort"})};let O=0;for(const e in T)"content-type"===e.toLowerCase()&&O++;O>=2&&delete T["content-type"];let M=!1;for(const t in T)if(T.hasOwnProperty(t)){const o=t.toLowerCase(),n=T[t];M="content-type"===o||M;try{_[o]||0===t.indexOf("for-wechatdevtools-fake-")?D.setRequestHeader("for-wechatdevtools-fake-"+t,n):D.setRequestHeader(t,T[t])}catch(t){return void m({errMsg:`${e}:fail ${t}`})}}"POST"!==k||M||D.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");const P=t.data;try{D.send(P)}catch(t){m({errMsg:e+":fail"})}return D},y=(e="")=>e,S=e=>{const t=[];for(const o in e)if("set-cookie"===o.toLowerCase()){const n=e[o],r=Object.prototype.toString.call(n);if("[object String]"===r){t.push(y(n.trim()));continue}if("[object Array]"===r){for(const e of n)t.push(y(e.trim()));continue}}return t},w=(e,t=",")=>{const o={};for(const n in e){const r=Object.prototype.toString.call(e[n]);o[n]="[object Array]"===r?e[n].join(t):e[n]}return o};function E(e){const t=new ArrayBuffer(e.length),o=new Uint8Array(t);for(let t=0,n=e.length;t<n;t++)o[t]=e.charCodeAt(t);return t}e.exports={request:b,createRequestTask:(e,t,o)=>{const n=m(o),s={id:g++,url:t.url,data:t.data,header:t.header,method:t.method,callback:(e,t)=>{let o={};o=0===t.errMsg.indexOf("request:ok")?{requestTaskId:e,state:"success",data:t.data,header:t.header,statusCode:t.statusCode,cookies:t.cookies}:{requestTaskId:e,state:"fail",errMsg:t.errMsg.replace(/^request:fail ?/,"")},delete d[e],r.emit("triggerOnEvent","onRequestTaskStateChange",o)}};n({errMsg:e+":ok",requestTaskId:s.id}),d[s.id]=s;s.xhr=b("request",t,s.callback.bind(void 0,s.id),(function(e){const t=Object.assign(Object.assign({},e),{requestTaskId:s.id});r.emit("triggerOnEvent","onRequestTaskStateChange",t)}))},operateRequestTask:(e,t,o)=>{const n=m(o),r=t.requestTaskId,s=t.operationType,a=d[r];if(!a)return n({errMsg:e+":fail task not found"});if("abort"!==s)return n({errMsg:`${e}:fail illegal operationType ${s}`});try{a.xhr.abort(),n({errMsg:e+":ok"})}catch(t){n({errMsg:`${e}:fail ${t}`})}}}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=o(46),r=o(8),s=o(9),a=o(5);t.securityDetails=window.securityDetails={"https://servicewechat.com":{isSecuryTLS:!0,securityState:"secure",isReady:!0,isSecuryCertificate:!0,tls:"TLS 1.2"}};let i=1e4;function c(e){const t=a.document.createElement("a");return t.href=e,{protocol:t.protocol,origin:t.origin,fullPath:`${t.origin}/${t.pathname}`}}function l(e){const{protocol:o,origin:r,fullPath:a}=c(e);let l=t.securityDetails[r];return n.isTourist()||!s.DevtoolsConfig.urlCheck||"https:"!==o?(l={isReady:!0,isSecuryTLS:!0,isSecuryCertificate:!0},t.securityDetails[r]=l,l):l||(l={isReady:!1,id:i++,tls:"",isSecuryTLS:!1,securityState:"",isSecuryCertificate:!1,protocol:o,origin:r,fullPath:a,url:e},t.securityDetails[r]=l,l)}t.parseURL=c,window.setSecurityDetails=function(e,o){const{origin:n}=c(e);o=JSON.parse(o);let s=t.securityDetails[n];s||(s=t.securityDetails[n]={});const{protocol:a,securityState:i}=o;let l=!1;a&&(l=parseFloat(a.replace("TLS ",""))>=1.2),s.isSecuryTLS=l,s.tls=a,s.securityState=i,s.isSecuryCertificate="insecure"!==i,s.isReady=!0,s.remoteAddress=o.remoteAddress,s.statusCode=o.statusCode;const u=s.id;r.emit("TLS_CHECK_READY_"+u,t.securityDetails[n])},t.getSecuryDetailsByURL=l,t.default={securityDetails:t.securityDetails,getSecuryDetailsByURL:l,parseURL:c}},function(e,t,o){"use strict";const n={0:"log",1:"info",2:"warn",3:"error"};e.exports={reportKeyValue:(e,t,o)=>{o({errMsg:e+":ok"})},reportIDKey:(e,t,o)=>{o({errMsg:e+":ok"})},traceEvent:(e,t,o)=>{o({errMsg:e+":ok"})},log:(e,t)=>{(t.dataArray||[]).forEach(e=>{const t=n[e.level];t&&e.msg&&console[t](e.msg)})}}},function(e,t,o){"use strict";const n=o(8),r=o(9),s=o(12),a=o(5),{checkUrl:i}=s;let c={},l=1,u=Date.now();function d(e){(0,a.alert)("SET_SOCKET_HEADER:"+JSON.stringify(e))}const g=a.WebSocket,f=function(e){return function(t){"function"==typeof e&&e(t)}},p={1e3:"normal closure",1001:"going away",1002:"protocol error",1003:"unsupported data",1004:"reserved",1005:"no status rcvd",1006:"abnormal closure",1007:"invalid frame payload data",1008:"policy violation",1009:"message too big",1010:"mandatory ext.",1011:"internal server error",1015:"tls handshake"};function m(e){console.group(new Date+" 无网络状态模拟"),console.error(`已开启无网络状态模拟，网络请求 ${e} 已被阻止；在模拟器工具栏切换网络状态，可恢复网络请求。`),console.groupEnd()}let _;function h(){_&&(_.close(),_=void 0);for(const e in c){const t=c[e].socket;t&&t.close()}}window.addEventListener("networkChange",e=>{r.DevtoolsConfig.networkStatus=e.detail.networkStatus,"none"===r.DevtoolsConfig.networkStatus&&h()}),n.on("RESET_INSTANCE",()=>{h(),c={},u=Date.now()}),e.exports={connectSocket:(e,t,o)=>{const{url:s,header:c}=t,l=f(o);if("none"===r.DevtoolsConfig.networkStatus)return m(s),void l({errMsg:e+":fail network is down"});if(!i(s,"socket"))return void l({errMsg:"connectSocket:fail "+r.urlCheckErrReason});if(c&&Object.keys(c).length>0&&d(c),_&&(_.readyState===g.OPEN||_.readyState===g.CONNECTING))return void l({errMsg:"connectSocket:fail websocket is connected"});try{let e=a.WebSocket;if(a.asLoader){const t=a.asLoader.getInstanceWindowSync();if(!t)return void l({errMsg:"connectSocket:fail runtime invalidated"});e=t.__global.WebSocket}_=new e(s,t.protocols||[])}catch(e){n.emit("triggerOnEvent","onSocketError",{errMsg:"未完成的操作"}),_=void 0}if(!_)return void l({errMsg:"connectSocket:fail"});_.binaryType="arraybuffer";const h=u===u;_.onopen=function(){h&&n.emit("triggerOnEvent","onSocketOpen",{})},_.onmessage=function(e){h&&n.emit("triggerOnEvent","onSocketMessage",{data:e.data})},_.onclose=function(e){h&&(n.emit("triggerOnEvent","onSocketClose",{code:e.code,reason:e.reason||p[e.code]||""}),_=void 0)},_.onerror=function(){h&&(n.emit("triggerOnEvent","onSocketError",{errMsg:"未完成的操作"}),_=void 0)},l({errMsg:"connectSocket:ok"})},sendSocketMessage:(e,t,o)=>{const n=f(o),r=t.data;let s="fail";if(_)try{_.readyState===g.OPEN?(_.send(r),s="ok"):s="fail webSocket is not connected"}catch(e){s="fail "+e.message}n({errMsg:`${e}:${s}`})},closeSocket:(e,t,o)=>{const n=f(o);if(_)try{_.close(t.code,t.reason),n({errMsg:"closeSocket:ok"})}catch(e){n({errMsg:"closeSocket:fail "+e})}else n({errMsg:"closeSocket:fail"});_=void 0},createSocketTask:(e,t,o)=>{var s;const u=f(o),g=Object.keys(c).length,{url:_,header:h,protocols:v,__skipDomainCheck__:b}=t,y=l++,S={socketTaskId:y,url:_,protocols:v,header:h};if(u({socketTaskId:y,errMsg:e+":ok"}),g>=r.MaxWebsocketConnect)return void setTimeout(()=>{console.group(new Date+" websocket 错误"),console.error(`同时最多发起 ${r.MaxWebsocketConnect} 个 socket 请求，更多请参考文档：https://developers.weixin.qq.com/miniprogram/dev/framework/ability/network.html`),console.groupEnd(),n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"error",errMsg:"exceed max task count"})});if("none"===r.DevtoolsConfig.networkStatus)return void setTimeout(()=>{m(_),n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"error",errMsg:"network is down"})});if(!b&&!i(_,"socket"))return void setTimeout(()=>{n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"error",errMsg:r.urlCheckErrReason})});c[y]=S,h&&Object.keys(h).length>0&&d(h);const w=(null===(s=__wxConfig.networkTimeout)||void 0===s?void 0:s.connectSocket)||6e4;let E,C=!1;try{let e=a.WebSocket;if(a.asLoader){const t=a.asLoader.getInstanceWindowSync();if(!t)return void u({errMsg:"connectSocket:fail runtime invalidated"});e=t.__global.WebSocket}E=new e(_,t.protocols||[])}catch(e){if(C)return;n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"error",errMsg:"未完成的操作"}),delete c[y]}if(!E)return;const k=setTimeout(()=>{var e;C=!0,n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"error",errMsg:"Timed out connecting to server."}),delete c[y],null===(e=null==E?void 0:E.close)||void 0===e||e.call(E)},w);E.binaryType="arraybuffer",E.onopen=function(){clearTimeout(k),n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"open"})},E.onmessage=function(e){if(C)return;const t=e.data;n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,data:t,state:"message"})},E.onclose=function(e){C||(n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"close",code:e.code,reason:e.reason||p[e.code]||""}),delete c[y])},E.onerror=function(){C||(n.emit("triggerOnEvent","onSocketTaskStateChange",{socketTaskId:y,state:"error",errMsg:"未完成的操作"}),delete c[y])},S.socket=E},operateSocketTask:(e,t,o)=>{const{socketTaskId:n,operationType:r,data:s}=t,a=f(o),i=c[n];if(!i)return a({errMsg:e+":fail task not found"});if("send"!==r)if("close"!==r)a({errMsg:`${e}:fail illegal operationType ${r}`});else try{i.socket.close(t.code,t.reason),a({errMsg:e+":ok"})}catch(t){a({errMsg:`${e}:fail ${t.message}`})}else try{i.socket.readyState===g.OPEN?(i.socket.send(s),a({errMsg:e+":ok"})):a({errMsg:e+":fail webSocket is not connected"})}catch(t){a({errMsg:`${e}:fail ${t.message}`})}}}},function(e,t,o){"use strict";const n=o(5);e.exports={encodeArrayBufferSync:async function(e,t,o){const r=t.format,s=t.data;try{const t=new n.TextEncoder(r).encode(s);return o({errMsg:e+":ok",buffer:t.buffer})}catch(t){return o({errMsg:`${e}:fail ${t}`})}},decodeArrayBufferSync:async function(e,t,o){const r=t.format,s=t.data;try{const t=new n.TextDecoder(r);return o({errMsg:e+":ok",result:t.decode(s)})}catch(t){return o({errMsg:e+":fail"})}}}},function(e,t,o){"use strict";const n=o(39),r=o(8),s=o(4),a=o(5);let i={};const c=["play","canplay","ended","stop","waiting","seeking","seeked"];s.registerCallback(e=>{const{command:t}=e;("LOAD_APPSERVICE"===t||"RESET"===t)&&d()});const l=function(e){return function(t){"function"==typeof e&&e(t)}},u=e=>{r.emit("triggerOnEvent","onAudioStateChange",e)};function d(){for(const e in i)i[e].pause(),i[e].remove();i={}}e.exports={createAudioInstance:(e,t,o)=>{const n=l(o),r=`${Date.now()}${Math.random()}`,s=a.document.createElement("audio");i[r]=s,n({errMsg:e+":ok",audioId:r})},destroyAudioInstance:function(e,t,o){const n=t.audioId,r=l(o);i[n]&&(i[n].pause(),i[n].remove(),delete i[n]),r({errMsg:e+":ok",audioId:n})},setAudioState:(e,t,o)=>{const r=l(o);try{const{audioId:o,src:s,startTime:a,autoplay:l,loop:d,referrerPolicy:g}=t,f=i[o];let{volume:p}=t;f.loop=d||!1,f.autoplay=l||!1,f.referrerPolicy=g||"no-referrer",p=parseFloat(p),f.volume=isNaN(p)?1:Math.max(0,Math.min(1,p));let m=1;if("number"==typeof(null==t?void 0:t.playbackRate)&&(m=Math.min(Math.max(t.playbackRate,.5),2)),f.playbackRate=m||f.playbackRate||1,s&&function(e,t,o,r){if(e._src===t)return;e._src=t;const s=n.sync("getInnerAudioContextSrc",{src:t,referrerPolicy:o});if("getInnerAudioContextSrc:fail"===s.errMsg)throw new Error("getInnerAudioContextSrc:fail");const a=s.durationResult;a&&(e._duration=a),e.src=s.srcResult,r&&(e.playbackRate=r)}(f,s,g,m),a){const e=()=>{f.removeEventListener("canplay",e),f.currentTime=a/1e3};f.addEventListener("canplay",e)}f.startTime=a||0,function(e){const t=i[e];if(t.initStateChage)return;t.initStateChage=!0,t.addEventListener("error",t=>{const o=t.currentTarget.error.code,n={audioId:e,state:"error",errMsg:"MediaError",errCode:1e4+parseInt(o,10)};u(n)}),t.addEventListener("pause",()=>{const o=t._isStop?"stop":"pause";t._isStop=!1;u({audioId:e,state:o})}),c.forEach(o=>{t.addEventListener(o,()=>{u({audioId:e,state:o})})})}(o),r({errMsg:e+":ok"})}catch(t){r({errMsg:e+":fail"})}},getAudioState:async function(e,t,o){const n=l(o),r=t.audioId,s=i[r];if(s){const{currentTime:t,paused:o,startTime:r}=s;let{duration:a}=s;const i=function(e){const t=e?e.buffered:"";if(t){const o=e.currentTime;for(let e=0,n=t.length;e<n;e++)if(t.start(e)<=o&&t.end(e)>=o)return t.end(e)}return 0}(s);a===1/0&&s._duration&&(a=s._duration),n({errMsg:e+":ok",duration:1e3*a,currentTime:1e3*t,paused:o,src:s._src,startTime:1e3*r,buffered:1e3*i,referrerPolicy:s.referrerPolicy})}else n({errMsg:e+":fail"})},operateAudio:(e,t,o)=>{const n=l(o),{operationType:r,audioId:s,currentTime:a}=t,c=i[s];c?("play"===r?(c.play(),c._isStop=!1):"pause"===r?c.pause():"stop"===r?(c._isStop=!0,c.pause(),c.currentTime=0):"seek"===r&&(c.currentTime=a/1e3),n({errMsg:e+":ok"})):n({errMsg:e+":fail"})},getAvailableAudioSources:async function(e,t,o){l(o)({errMsg:e+":ok",audioSources:["auto"]})}}},function(e,t,o){"use strict";const n=o(9),r=o(4),s=o(39),{initMusic:a,playMusic:i,resumeMusic:c,stopMusic:l,pauseMusic:u,seekMusic:d,getAudioBufferd:g,getAudio:f,removeAudio:p}=o(102),{actionsConfig:m,musicStatusConfig:_,clickkeyConfig:h}=n,v=function(e){return function(t){"function"==typeof e&&e(t)}};r.registerCallback(e=>{const{command:t}=e;"LOAD_APPSERVICE"===t?p():"BACKGROUND_AUDIO_STOP"===t?l():"BACKGROUND_AUDIO_PAUSE"===t?u():"BACKGROUND_AUDIO_RESUME"===t&&c()});const b=(e,t)=>{r.send({command:"APPSERVICE_SDK_BACKGROUND_AUDIO_ACTION",data:{type:e,payload:t}})};e.exports={getMusicPlayerState:function(e,t,o){const n=f(),r=v(o);if(n)try{return void r({dataUrl:n.src,duration:Math.floor(n.duration),currentPosition:Math.floor(n.currentTime),status:n.paused?0:1,downloadPercent:Math.round(100*n.buffered.end(0)/n.duration),errMsg:e+":ok",referrerPolicy:n.referrerPolicy})}catch(t){r({status:2,errMsg:e+":ok"})}else r({errMsg:e+":ok",status:2})},operateMusicPlayer:function(e,t,o){const n=t.operationType,r=v(o);try{if("play"===n)a(),i({src:t.dataUrl||"",startTime:t.position||0,playbackRate:t.playbackRate||1}),b(m.SIMULATOR_SET_BACKGROUND_AUDIO,{mode:"music",title:t.title||"",coverImgUrl:t.coverImgUrl||"",src:t.dataUrl||"",startTime:t.position||0}),b(m.TOOLBAR_SET_CLICKKEY,h.MUSICCARD);else if("resume"===n)c();else if("pause"===n){if(!u())return void r({errMsg:e+":fail background audio not playing"})}else if("seek"===n)d({currentTime:t.position});else{if("stop"!==n)return void r({errMsg:e+":fail illegal operationType"});if(!l())return void r({errMsg:e+":fail background audio not playing"});b(m.SIMULATOR_SET_BACKGROUND_AUDIO,{status:_.MUSIC_STATE_END})}return void r({errMsg:e+":ok"})}catch(t){r({errMsg:`${e}:fail ${t.toString()}`})}},setBackgroundAudioState:function(e,t,o){const n=v(o);try{if(!t.title)return void n({errMsg:e+":fail title is nil!"});a();const o=f();return o&&t.referrerPolicy!==o.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.src&&i({src:t.src,startTime:t.startTime||0,playbackRate:t.playbackRate||1}),b(m.SIMULATOR_SET_BACKGROUND_AUDIO,Object.assign({mode:"backgroundaudio"},t)),b(m.TOOLBAR_SET_CLICKKEY,h.MUSICCARD),void n({errMsg:e+":ok"})}catch(t){n({errMsg:`${e}:fail ${t.toString()}`})}},operateBackgroundAudio:function(e,t,o){const n=t.operationType,r=v(o);try{if("play"===n)i({src:t.src,startTime:t.startTime||0,playbackRate:t.playbackRate||1}),b(m.SIMULATOR_SET_BACKGROUND_AUDIO,Object.assign({mode:"backgroundaudio"},t)),b(m.TOOLBAR_SET_CLICKKEY,h.MUSICCARD);else if("pause"===n)u();else if("stop"===n)l(),b(m.SIMULATOR_SET_BACKGROUND_AUDIO,{status:_.MUSIC_STATE_END});else{if("seek"!==n)return void r({errMsg:e+":fail illegal operationType"});d({currentTime:t.currentTime})}return void r({errMsg:e+":ok"})}catch(t){r({errMsg:`${e}:fail ${t.toString()}`})}},getBackgroundAudioState:function(e,t,o){const n=v(o),r=s.sync(e,{});try{if(r.errMsg===e+":fail")return void n({errMsg:e+":fail"});const t=f();return void n({duration:t?t.duration:0,currentTime:t?t.currentTime:0,paused:!t||t.paused,src:t?t._src:"",buffered:g(),title:r.title||"",epname:r.epname||"",singer:r.singer||"",coverImgUrl:r.coverImgUrl||"",webUrl:r.webUrl||"",startTime:r.startTime||"",errMsg:e+":ok"})}catch(t){n({errMsg:e+":fail"})}}}},function(e,t,o){"use strict";const n=o(4),r=o(8),s=o(9),a=o(5),{actionsConfig:i,musicStatusConfig:c,referrerConfig:l}=s;let u;const d=(e,t)=>{n.send({command:"APPSERVICE_SDK_BACKGROUND_AUDIO_ACTION",data:{type:e,payload:t}})},g=(e,t)=>{r.emit("triggerOnEvent",e,t)},f=()=>{d(i.SIMULATOR_SET_BACKGROUND_AUDIO,{status:c.MUSIC_STATE_PLAY}),g("onMusicPlay",{dataUrl:u._src}),g("onBackgroundAudioStateChange",{state:"play"})},p=()=>{u&&!u.ended&&(u.error||d(i.SIMULATOR_SET_BACKGROUND_AUDIO,{status:c.MUSIC_STATE_PAUSE}),g("onMusicPause",{dataUrl:u._src}),g("onBackgroundAudioStateChange",{state:"pause"}))},m=()=>{u&&(d(i.SIMULATOR_SET_BACKGROUND_AUDIO,{status:c.MUSIC_STATE_END}),g("onMusicEnd",{dataUrl:u._src}),g("onBackgroundAudioStateChange",{state:"ended"}),y())},_=()=>{g("onBackgroundAudioStateChange",{state:"waiting"})},h=()=>{g("onBackgroundAudioStateChange",{state:"canplay"})},v=e=>{if(!u)return;d(i.SIMULATOR_SET_BACKGROUND_AUDIO,{status:c.MUSIC_STATE_ERROR});const{target:t}=e,{error:o}=t;let n=o.code;n=n===o.MEDIA_ERR_NETWORK?10002:n===o.MEDIA_ERR_DECODE?10003:10001;const r=o.code;g("onMusicError",{dataUrl:u._src,errMsg:"Error: "+u.error.code}),g("onBackgroundAudioStateChange",{state:"error",errMsg:r,errCode:n}),y()};const b=()=>{u.play(),u.removeEventListener("canplay",b)};function y(){u&&(u.removeEventListener("play",f),u.removeEventListener("pause",p),u.removeEventListener("ended",m),u.removeEventListener("waiting",_),u.removeEventListener("canPlay",h),u.removeEventListener("canPlay",b),u.removeEventListener("error",v),u.pause(),u.remove(),u=null)}e.exports={initMusic:function(){u||(u=a.document.createElement("audio"),u.addEventListener("play",f),u.addEventListener("pause",p),u.addEventListener("ended",m),u.addEventListener("waiting",_),u.addEventListener("canplay",h),u.addEventListener("error",v))},playMusic:function(e={}){if(u.removeEventListener("canplay",b),e.src&&e.src!==u._src){u._src=e.src,u.src="origin"===u.referrerPolicy?`${e.src}${l.referrerPolicyOrigin}`:`${e.src}${l.referrerPolicyNoReferrer}`;let t=1;"number"==typeof(null==e?void 0:e.playbackRate)&&(t=Math.min(Math.max(e.playbackRate,.5),2)),u.addEventListener("canplay",b),u.load(),u.playbackRate=t||u.playbackRate||1,u.currentTime=e.startTime||0}else u.src&&u.play()},pauseMusic:function(){return!!u&&(u.paused||u.pause(),!0)},resumeMusic:function(){(null==u?void 0:u.paused)&&u.play()},stopMusic:function(){if(!u)return!1;const e=u._src;return setTimeout(()=>{d(i.SIMULATOR_SET_BACKGROUND_AUDIO,{status:c.MUSIC_STATE_END}),g("onMusicEnd",{dataUrl:e}),g("onBackgroundAudioStateChange",{state:"stop"})}),y(),!0},seekMusic:function(e={}){u&&(u.currentTime=1*e.currentTime,u.paused||u.dispatchEvent(new Event("play")))},getAudioBufferd:function(){const e=u?u.buffered:"";if(e){const t=u.currentTime;for(let o=0,n=e.length;o<n;o++)if(e.start(o)<=t&&e.end(o)>=t)return e.end(o)}return 0},getAudio:function(){return u},removeAudio:y}},function(e,t,o){"use strict";const n=o(57),r=o(58),s=Object.assign(Object.assign({},n),r);e.exports=s},function(e,t,o){"use strict";const n=o(12),{arrayBufferToBase64:r,isKindOfArrayBuffer:s,isKindOfArray:a}=n,i={invokeLockStepMethod:{is:e=>a(e)?e.every(e=>s(e)):s(e),trans:(e,t)=>(e.__dataisab=!0,a(t)?t.map(e=>r(e)):r(t))},writeFile:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},writeFileSync:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},fs_appendFile:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},fs_appendFileSync:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},uploadToCommonCDN:{is:(e,t)=>"fileData"===t&&s(e),trans:(e,t)=>({__dataisab:!0,value:r(t)})},sendUDPSocketMessage:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},writeTCPSocket:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},write:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},writeSync:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t))},read:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t)),saveOrigin:!0},readSync:{is:e=>s(e),trans:(e,t)=>(e.__dataisab=!0,r(t)),saveOrigin:!0}};e.exports=i},function(e,t,o){"use strict";const n=o(5),r=n.navigator.userAgent,s=(e,t,o)=>{if(!/gameservice/.test(r))return t;const s=t.canvasId,a=()=>{o({errMsg:e+":fail canvas not found"})};if(!s)return void(/Sync$/.test(e)?a():setTimeout(a));const{x:i=0,y:c=0,width:l=s.width,height:u=s.height,destWidth:d=s.width,destHeight:g=s.height,fileType:f="png"}=t,p=n.document.createElement("canvas");Object.setPrototypeOf(p,n.canvasProto),p.width=d,p.height=g;const m=p.getContext("2d");m&&(Object.setPrototypeOf(m,n.canvas2dContextProto),m.drawImage(s,i,c,l,u,0,0,d,g));const _="jpg"===f?"image/jpeg":"image/png",h=isNaN(t.quality)?1:t.quality>0&&t.quality<=1?t.quality:1;return{dataURL:p.toDataURL(_,h).replace(/^data:image\/(jpg|png);base64,/,""),fileType:f}},a={canvasToTempFilePath:s,canvasToTempFilePathSync:s};e.exports=a},function(e,t,o){"use strict";const n=o(5);e.exports={modifyComponentData:(e,t,o)=>{n.WAServiceGlobal.__virtualDOM__.getNodeById(e,parseInt(o)).setData(t)}}},function(e,t,o){"use strict";const n=o(4),r=o(56),s=o(39),a=o(12),i=o(8);e.exports=function(e){const t={};let o=1,c=!1,l=!1;const u=e=>{const{command:o,data:n}=e;if("APPSERVICE_BEFORE_INVOKE_CALLBACK"===o){if(n.res.needImplement){const{api:e,args:o}=n.res;r[e](e,o,t[n.callbackID])}else{const e=n.callbackID,o=t[e];"function"==typeof o&&o(n.res)}delete t[n.callbackID]}else if("APPSERVICE_AFTER_INVOKE_CALLBACK"===o){const e=n.callbackID,o=t[e];"function"==typeof o&&o(n.res)}},d=function(e,t,o){return function(e){const n=Object.assign(Object.assign({},e),o);"function"==typeof t&&t(n)}};return i.once("RESET_INSTANCE",()=>{c=!0,n.removeCallback(u)}),l||(l=!0,n.registerCallback(u)),{beforeinvoke:function(i,l,u,g){if(c)return;const{isAsync:f,preventDefault:p,pluginId:m}=g;a.debugLog(`${new Date} WeixinJSBridge beforeinvoke ${i}`,arguments),a.debugInfo({type:"beforeinvoke",eventName:i,data:arguments,timesmap:new Date});let _=l;try{JSON.stringify(l)}catch(e){_=[{error:!0,errMsg:e}]}if(!1===p)return void n.send({command:"APPSERVICE_BEFORE_INVOKE",data:{api:i,args:_,preventDefault:!1},common:e});const h=d(0,u,{}),v=o++;if(f)t[v]=h,n.send({command:"APPSERVICE_BEFORE_INVOKE",data:{api:i,args:_,pluginId:m,callbackID:v},common:e});else{const e=s.sync(i,_,{beforeInvoke:!0,pluginId:m});e.needImplement?r[i](i,l,h):h(e)}},afterinvoke:function(r,i,l,u){if(c)return;const{isAsync:g,preventDefault:f,pluginId:p}=u;a.debugLog(`${new Date} WeixinJSBridge afterinvoke ${r}`,arguments),a.debugInfo({type:"afterinvoke",eventName:r,data:arguments,timesmap:new Date});const{res:m,args:_}=i;let h=_;try{JSON.stringify(_)}catch(e){h=[{error:!0,errMsg:e}]}const v={res:m,args:h,pluginId:p};if(!1===f)return void n.send({command:"APPSERVICE_AFTER_INVOKE",data:{api:r,args:v,preventDefault:!1},common:e});const b=d(0,l,{}),y=o++;if(g)t[y]=b,n.send({command:"APPSERVICE_AFTER_INVOKE",data:{api:r,args:v,callbackID:y,common:e}});else{b(s.sync(r,v,{afterInvoke:!0}))}}}}},function(e,t,o){"use strict";const n=o(12),r=o(4),s=o(8);e.exports=function(e){let t=!1,o=!0,a=!1;const i=t=>{const{command:n,data:s}=t;if("WRITE_APP_DATA"===n){const e={};getCurrentPages().forEach(t=>{e[t.__route__||t.route]=t});for(const t in s){const n=s[t],r=n.__webviewId__;e[t]&&"function"==typeof e[t].setData?(o=!1,e[t].setData(n)):(null===wx||void 0===wx?void 0:wx.invokeWebviewMethod)?(o=!1,wx.invokeWebviewMethod({name:"appDataChange",args:{data:n}})):c("appDataChange",{data:{data:n}},[r],!0),Object.assign(__wxAppData[t],n);for(const e in __wxAppData[t])void 0===n[e]&&delete __wxAppData[t][e]}}else"GET_APP_DATA"===n&&r.send({command:"SEND_APP_DATA",data:__wxAppData,common:e})};function c(s,a,i,c){var l;if(!t){if(i=i?i.filter(e=>void 0!==e):[],n.debugLog(`${new Date} WeixinJSBridge publish ${s}`,arguments),a&&0!==s.indexOf("canvas")){const e=JSON.stringify(a).length;e>1048576&&(console.group(new Date+" 数据传输长度过长"),console.warn(`${"vdSyncBatch"===s?"setData":s} 数据传输长度为 ${Math.floor(e/1024)} KB，存在有性能问题！`),console.groupEnd())}n.debugInfo({type:"publish",eventName:s,data:arguments,timesmap:new Date}),"appDataChange"!==s&&"pageInitData"!==s&&"__updateAppData"!==s||c||r.send({command:"SEND_APP_DATA",data:__wxAppData,common:e}),"invokeWebviewMethod"===s&&"appDataChange"===(null===(l=null==a?void 0:a.data)||void 0===l?void 0:l.name)&&(o&&r.send({command:"SEND_APP_DATA",data:__wxAppData,common:e}),o=!0),"vdSync"!==s&&"vdSyncBatch"!==s||(o&&r.send({command:"SEND_APP_DATA",data:__wxAppData,common:e}),o=!0),r.send({command:"APPSERVICE_PUBLISH",data:{eventName:s,data:a,webviewIds:i},common:e})}}return s.once("RESET_INSTANCE",()=>{t=!0,r.removeCallback(i)}),a||(a=!0,r.registerCallback(i)),{publish:c}}},function(e,t,o){"use strict";const n=o(12),r=o(110),s=o(4),a=o(8);e.exports=function(e){let t=!1;return a.once("RESET_INSTANCE",()=>{t=!0}),{publishSync:function(o,a,i){if(t)return;let c;if(i=i?i.filter(e=>void 0!==e):[],n.debugLog(`${new Date} WeixinJSBridge publishsync ${o}`,arguments),n.debugInfo({type:"publishsync",eventName:o,data:arguments,timesmap:new Date}),0===i.length&&(c=["fail no such target",null]),c=r.sync("publishsync",{eventName:o,data:a,webviewIds:i},1e4,"fail timeout"),c[0])throw new Error(c[0]);return"vdSyncSync"===o&&s.send({command:"SEND_APP_DATA",data:__wxAppData,common:e}),c[1]}}}},function(e,t,o){"use strict";const n=o(5);e.exports={sync:(e,t,o,r)=>{const s={args:t,syncTimeout:o,syncTimeoutMsg:r},a=new n.XMLHttpRequest;if(a.open("POST",`/jsbridge/${e}?t=${Date.now()}`,!1),a.send(JSON.stringify(s)),200===a.status)return JSON.parse(a.responseText)}}},function(e,t,o){"use strict";const n=o(12),r=o(8),s=o(4);e.exports=function(){const e=r.instanceScope();let t={},o=!1,a=!1;function i(e,o,n){const r=t[e];if("function"==typeof r)try{r(o,n)}catch(e){console.error(e)}}const c=e=>{const{command:t,data:o,fromWebviewID:n}=e;"WEBVIEW_PUBLISH"===t&&i(o.eventName,o.data,n)};return a||(a=!0,s.registerCallback(c)),e.on("triggerSubscribeEvent",(e,t,o)=>{i(e,t,o)}),r.once("RESET_INSTANCE",()=>{o=!0,t={},s.removeCallback(c)}),{subscribe:function(e,r){o||(n.debugLog(`${new Date} WeixinJSBridge subscribe ${e}`,arguments),n.debugInfo({type:"subscribe",eventName:e,data:arguments,timesmap:new Date}),t[e]=r)},triggerSubscribeEvent:i}}},function(e,t,o){"use strict";const n=o(5),r=o(4);e.exports=function(){if(["Caches","screen","performance ","getComputedStyle","openDatabase","btoa","Image"].forEach(e=>{delete window[e]}),window.chrome=void 0,"complete"===n.document.readyState)n.history.replaceState({},n.document.title||"",location.href+"?load"),n.alert("MAINFRAME_LOADED");else{const e=()=>{n.history.replaceState({},n.document.title||"",location.href+"?load"),n.alert("MAINFRAME_LOADED"),n.removeEventListener("load",e)};n.addEventListener("load",e)}let e=!1;const t=WebAssembly.Memory;function o(){e||(e=!0,r.send({command:"PAGE_EXIST_WASM"}))}WebAssembly.Memory=function(...e){return o(),new t(...e)},WebAssembly.Memory.prototype=t.prototype;const s=WebAssembly.Instance;WebAssembly.Instance=function(...e){return o(),new s(...e)},WebAssembly.Instance.prototype=s.prototype}},function(e,t,o){"use strict";const n=o(4),r=o(5),s=(e,t)=>{const o=r.document.getElementById("myCanvas"),n=new r.Touch({identifier:1,target:o,clientX:e,clientY:t,pageX:e,pageY:t}),s=new r.TouchEvent("touchstart",{bubbles:!0,touches:[n],targetTouches:[n],changedTouches:[n]});r.canvasProto.dispatchEvent.call(o,s)},a=(e,t)=>{const o=r.document.getElementById("myCanvas"),n=new r.Touch({identifier:1,target:o,clientX:e,clientY:t,pageX:e,pageY:t}),s=new r.TouchEvent("touchend",{bubbles:!0,changedTouches:[n]});r.canvasProto.dispatchEvent.call(o,s)},i=(e,t)=>{const o=r.document.getElementById("myCanvas"),n=new r.Touch({identifier:1,target:o,clientX:e,clientY:t,pageX:e,pageY:t}),s=new r.TouchEvent("touchmove",{bubbles:!0,touches:[n],targetTouches:[n],changedTouches:[n]});r.canvasProto.dispatchEvent.call(o,s)};let c=!1,l=!0;const u=e=>{c&&l&&(l=!1,setTimeout(()=>{l=!0},250),r.WeixinJSBridge.invoke("private_ideplugin_excute_command",{pluginId:"inspector_v1_game",command:"INSPECT_MOVE",data:{x:e.pageX,y:e.pageY}}))},d=e=>{c&&r.WeixinJSBridge.invoke("private_ideplugin_excute_command",{pluginId:"inspector_v1_game",command:"INSPECT_RESULT",data:{x:e.pageX,y:e.pageY}})};e.exports={init:()=>{n.registerCallback(async e=>{const{command:t,data:o}=e;let l;switch(t){case"Driver.game.dumpUI":l=(()=>{let e={};try{e=window.__monkeyInject.engine.dumpUI()}catch(e){return{status:17,value:{message:e.toString()}}}return{status:0,value:e}})();break;case"Driver.game.tap":l=(e=>(s(e.x,e.y),a(e.x,e.y),{status:0}))(o.data);break;case"Driver.game.swipe":l=await(e=>{const{startX:t=0,startY:o=0,endX:n=0,endY:r=0,duration:c=0}=e;s(t,o);let l=Math.floor(c/20);l<=0&&(l=1);const u=(n-t)/l,d=(r-o)/l;return new Promise(e=>{const s=function(c){i(parseInt(t+c*u,10),parseInt(o+c*d,10)),c<l?setTimeout(()=>{s(c+1)},20):(a(n,r),e({status:0}))};s(0)})})(o.data);break;case"Driver.game.touchstart":l=await(e=>(s(e.x,e.y),{status:0}))(o.data);break;case"Driver.game.touchend":l=await(e=>(a(e.x,e.y),{status:0}))(o.data);break;case"Driver.game.touchmove":l=await(e=>(i(e.x,e.y),{status:0}))(o.data);break;case"Driver.game.setInspectMode":l=(e=>(c=e.inspected,c?(r.document.addEventListener("mousemove",u),r.document.addEventListener("mouseup",d)):(r.document.removeEventListener("mousemove",u),r.document.removeEventListener("mouseup",d)),{status:0}))(o.data);break;default:return}n.send({command:t+".callback",data:{callbackID:o.callbackID,res:l}})})}}},function(e,t,o){"use strict";const n=o(5),r=o(4),s=-1!==n.navigator.userAgent.indexOf("game"),a=(e,t)=>{r.send({command:"SYSTEM",data:{api:e,data:t}})};r.registerCallback(e=>{const{command:t,data:o}=e;"SYSTEM_CALLBACK"===t&&function(e,t){switch(e){case"showSystemInfo":{const e=t.memory,o=t.restartInfo,n=o.restartTimes;console.group(new Date+" 工具系统信息"),console.info(`${o.beginTime} 启动工具，执行编译 ${n} 次， 当前内存占用 ${e.toFixed(2)}m`),console.table(t.info),console.groupEnd();break}case"checkProxy":console.group(new Date+" 代理信息"),console.table(t),console.groupEnd();break;case"showDecryptedInfo":console.group(new Date+" 加解密信息"),console.table(t),console.groupEnd();break;case"showMyOpenId":console.group(new Date+" openId"),console.log(t.openid),console.groupEnd();break;case"getMessageTunnelInfo":console.group(new Date+" Message Tunnel Info"),console.log(t),console.groupEnd();break;case"originalPositionFor":console.group(new Date+" Origin Position"),t.error?console.error(t.error):console.log(t.origin),t.codeFrame&&console.log(t.codeFrame),console.groupEnd();break;case"setSourceMapContent":console.group(new Date+" setSourceMapContent"),console.log(t),console.groupEnd();break;case"checkUpdateWechatDevtools":if(console.group(new Date+" 检查版本更新"),t){const{stringVersion:e,fromVersion:o,packType:n,silence:r}=t,s={0:"安装包",1:"大代码包",2:"小代码包"};console.log("需要从",o,s[n],r?"静默":"","更新到",e),console.log(t)}else console.error("开发者工具没有灰度计划");console.groupEnd();break;case"getDebuggerVendor":console.group(new Date+" 拉取调试基础库结果"),t?console.log("拉取调试基础库成功，请在基础库列表中选择develop"):console.warn("未能拉取到调试基础库，请稍后再试"),console.groupEnd();break;default:;}}(o.api,o.data)});const i=function(e){if("string"!=typeof e)return console.log("param should be string");console.log("checking..."),a("checkProxy",e)},c=()=>{a("cleanAppCache"),console.warn("应用缓存已清理完成，建议重新启动")},l=()=>{const e={};for(const t in window.securityDetails)if(0!==t.indexOf("http://"+__wxConfig.apphash)){const o=window.securityDetails[t];delete o.id,delete o.command,delete o.isReady,delete o.url,e[t]=o}console.table(e)},u=()=>{console.table([{fun:"build","arg[0]":"","arg[1]":"",example:"build()",description:"build / reload"},{fun:"preview","arg[0]":"","arg[1]":"",example:"preview()",description:"preview with QR code"},{fun:"upload","arg[0]":"","arg[1]":"",example:"upload()",description:"upload the app"},{fun:"showDebugInfo","arg[0]":"type -- String || Array; publish on subscribe invoke GetMsg","arg[1]":"eventName -- String || Array;",example:'showDebugInfo() showDebugInfo("publish") showDebugInfo(["publish", "invoke"], "onAppRoute")',description:"open tools logs"},{fun:"closeDebug"},{fun:"showDebugInfoTable"},{fun:"openToolsLog","arg[0]":"","arg[1]":"",example:"openToolsLog()",description:"open log folder"},{fun:"openPlugin","arg[0]":"","arg[1]":"",example:"openPlugin()",description:"open plugin folder"},{fun:"openVendor","arg[0]":"","arg[1]":"",example:"openVendor()",description:"open vendor folder"},{fun:"openCrashDir","arg[0]":"","arg[1]":"",example:"openCrashDir()",description:"open crash folder"},{fun:"openCache","arg[0]":"","arg[1]":"",example:"openCache()",description:"open Cache folder"},{fun:"openEngine","arg[0]":"","arg[1]":"",example:"openEngine()",description:"open engine folder"},{fun:"openEditorCache","arg[0]":"","arg[1]":"",example:"openEditorCache()",description:"open editor cache folder"},{fun:"showRequestInfo","arg[0]":"","arg[1]":"",example:"showRequestInfo()",description:"show request info"},{fun:"showSystemInfo","arg[0]":"","arg[1]":"",example:"showSystemInfo()",description:"show tools info"},{fun:"showMyOpenId","arg[0]":"","arg[1]":"",example:"showMyOpenId()",description:"show openid"},{fun:"checkProxy","arg[0]":"type -- String; url",example:'checkProxy("http://www.qq.com")',description:"checkProxy of the input url"},{fun:"showDecryptedInfo","arg[0]":"",example:"showDecryptedInfo()",description:"show API decrypted info"},{fun:"cleanAppCache","arg[0]":"",example:"cleanAppCache()",description:"clean application cache"},{fun:"cleanEngineWASM","arg[0]":"",example:"cleanEngineWASM()",description:"clean engine wasm cache"},{fun:"setSourceMapContent","arg[0]":"the source map content",example:"setSourceMapContent({})",description:"set the source map for analyze"},{fun:"originalPositionFor","arg[0]":"line","arg[1]":"column",example:"originalPositionFor(1, 2)",description:"get the origin source position"},{fun:"getDebuggerVendor",example:"getDebuggerVendor()",description:"get the debugger verion of publib"}])};e.exports=e=>{e.getMessageTunnelInfo=function(){a("getMessageTunnelInfo")},Object.defineProperty(e,"help",{get:()=>u}),Object.defineProperty(e,"showRequestInfo",{get:()=>l}),Object.defineProperty(e,"build",{get:()=>()=>a("build")}),Object.defineProperty(e,"preview",{get:()=>()=>a("preview")}),Object.defineProperty(e,"upload",{get:()=>()=>a("upload")}),Object.defineProperty(e,"openToolsLog",{get:()=>()=>a("openToolsLog")}),Object.defineProperty(e,"openInspect",{get:()=>()=>a("openInspect")}),Object.defineProperty(e,"openGameEngineDebugMode",{get:()=>()=>a("openGameEngineDebugMode")}),Object.defineProperty(e,"closeGameEngineDebugMode",{get:()=>()=>a("closeGameEngineDebugMode")}),Object.defineProperty(e,"openGameEngineAssetsInspect",{get:()=>()=>a("openGameEngineAssetsInspect")}),Object.defineProperty(e,"openUserDataPath",{get:()=>()=>a("openUserDataPath")}),Object.defineProperty(e,"openPlugin",{get:()=>()=>a("openPlugin")}),Object.defineProperty(e,"openVendor",{get:()=>()=>a("openVendor")}),Object.defineProperty(e,"openCrashDir",{get:()=>()=>a("openCrashDir")}),Object.defineProperty(e,"openCache",{get:()=>()=>a("openCache")}),Object.defineProperty(e,"openEngine",{get:()=>()=>a("openEngine")}),Object.defineProperty(e,"cleanEngineWASM",{get:()=>()=>a("cleanEngineWASM")}),Object.defineProperty(e,"openEditorCache",{get:()=>()=>a("openEditorCache")}),Object.defineProperty(e,"showSystemInfo",{get:()=>()=>a("showSystemInfo")}),Object.defineProperty(e,"showMyOpenId",{get:()=>()=>a("showMyOpenId")}),Object.defineProperty(e,"checkProxy",{get:()=>i}),Object.defineProperty(e,"syncMessage",{get:()=>()=>a("syncMessage")}),Object.defineProperty(e,"showDecryptedInfo",{get:()=>()=>a("showDecryptedInfo")}),Object.defineProperty(e,"cleanAppCache",{get:()=>c}),Object.defineProperty(e,"restoreLocalData",{get:()=>()=>a("restoreLocalData")}),Object.defineProperty(e,"setSourceMapContent",{get:()=>e=>a("setSourceMapContent",e)}),Object.defineProperty(e,"originalPositionFor",{get:()=>(e,t)=>a("originalPositionFor",{line:e,column:t})}),Object.defineProperty(e,"checkUpdateWechatDevtools",{get:()=>e=>{a("checkUpdateWechatDevtools",e)}}),Object.defineProperty(e,"getDebuggerVendor",{get:()=>()=>{console.log("拉取调试基础库中..."),a("getDebuggerVendor")}}),s&&(Object.defineProperty(e,"useStaticServer",{get:()=>e=>a("useStaticServer",e)}),Object.defineProperty(e,"saveJSCoreSnapshot",{get:()=>e=>a("saveJSCoreSnapshot",e)}))}}]);