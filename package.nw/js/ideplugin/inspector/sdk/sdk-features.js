import{ConsoleModel}from"./ConsoleModel.js";import{isRemoteDebugGame,isRemoteAppserviceMode,getMasterProxyPort}from"../wx_main/util.js";import{NetworkLog}from"./NetworkLog.js";import{each,some,contain,noop,nextTick}from"../third_party/licia.js";import{getProxyPort}from"../wx_main/util.js";if(wxMain.isFeatureEnabled("correctRemoteDebugContext")&&"RemoteDebug"===wxMain.type&&!isRemoteDebugGame()&&isRemoteAppserviceMode()){const e=ConsoleModel.prototype.addMessage,t=["WASubContext","WAServiceMainContext"];ConsoleModel.prototype.addMessage=function(o){if(!("error"!==o.type&&t.some(e=>o.url&&o.url.includes(e))||void 0===o.url&&"error"!==o.type&&"console-api"===o.source))return e.apply(this,[o])}}if(wxMain.isFeatureEnabled("hideRequest")){let e=!1;nextTick(()=>{wxMain.on(WxMain.Events.showAllRequests,()=>{e=!0})});const t=wxMain.getFeatureOptions("hideRequest").filter||noop;function filterRequest(o){if(e)return!1;const r=o._url;if(/(\?|&)devtools_ignore=true(&|$)/.test(r))return!0;const i=navigator.userAgent,s=[getProxyPort()];contain(i,"simple")&&s.push(getMasterProxyPort());const n=["https://servicewechat.com/wxa-qbase/qbasecheckresult"];return each(s,e=>{n.push(`http://127.0.0.1:${e}/appservice`,`http://127.0.0.1:${e}/__pageframe__/mainframe.html`,`http://127.0.0.1:${e}/__pageframe__/instanceframe.html`,`http://127.0.0.1:${e}/favicon.ico`,`http://127.0.0.1:${e}/apihelper`,`http://127.0.0.1:${e}/jsbridge`,`http://127.0.0.1:${e}/calibration`)}),!!some(n,e=>contain(r,e))||!!t(r)}const o=NetworkLog.prototype._addRequest;NetworkLog.prototype._addRequest=function(e){filterRequest(e)||o.call(this,e)};const r=NetworkLog.prototype._onRequestUpdated;NetworkLog.prototype._onRequestUpdated=function(e){filterRequest(e.data)||r.call(this,e)}}